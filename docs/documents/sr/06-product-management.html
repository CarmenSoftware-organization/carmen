<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature: Product Management and Catalog System - Carmen ERP Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --secondary: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg-light: #f8fafc;
            --bg-white: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: var(--bg-light);
            color: var(--text-primary);
            line-height: 1.6;
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background: var(--bg-white);
            border-right: 1px solid var(--border);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            padding: 2rem 0;
        }

        .sidebar-header {
            padding: 0 1.5rem;
            margin-bottom: 2rem;
        }

        .sidebar-header h1 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .back-link:hover {
            color: var(--primary);
        }

        .sidebar nav {
            padding: 0 1rem;
        }

        .nav-section {
            margin-bottom: 1.5rem;
        }

        .nav-section h3 {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            padding: 0 0.5rem;
            margin-bottom: 0.5rem;
        }

        .nav-section ul {
            list-style: none;
        }

        .nav-section a {
            display: block;
            padding: 0.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .nav-section a:hover,
        .nav-section a.active {
            background: var(--bg-light);
            color: var(--primary);
        }

        .main-content {
            margin-left: 280px;
            flex: 1;
            padding: 2rem;
            max-width: calc(100% - 280px);
        }

        .breadcrumb {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .breadcrumb a {
            color: var(--primary);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .content-wrapper {
            display: flex;
            gap: 2rem;
        }

        .document-content {
            flex: 1;
            background: var(--bg-white);
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
            min-width: 0;
        }

        .toc-sidebar {
            width: 250px;
            flex-shrink: 0;
        }

        .toc-sticky {
            position: sticky;
            top: 2rem;
            background: var(--bg-white);
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
        }

        .toc-title {
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .toc-list {
            list-style: none;
        }

        .toc-list a {
            display: block;
            padding: 0.25rem 0;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            transition: color 0.2s;
        }

        .toc-list a:hover {
            color: var(--primary);
        }

        .toc-list .toc-h2 {
            margin-left: 0;
            font-weight: 500;
        }

        .toc-list .toc-h3 {
            margin-left: 1rem;
            font-size: 0.8125rem;
        }

        .toc-list .toc-h4 {
            margin-left: 2rem;
            font-size: 0.75rem;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        h2 {
            font-size: 1.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border);
            color: var(--text-primary);
        }

        h3 {
            font-size: 1.25rem;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        h4 {
            font-size: 1.125rem;
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        p {
            margin-bottom: 1rem;
        }

        ul, ol {
            margin-bottom: 1rem;
            padding-left: 2rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        code {
            background: var(--bg-light);
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.875rem;
        }

        pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin-bottom: 1rem;
        }

        pre code {
            background: transparent;
            padding: 0;
            color: inherit;
        }

        blockquote {
            border-left: 4px solid var(--primary);
            padding-left: 1rem;
            margin: 1rem 0;
            color: var(--text-secondary);
            font-style: italic;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
        }

        th, td {
            border: 1px solid var(--border);
            padding: 0.75rem;
            text-align: left;
        }

        th {
            background: var(--bg-light);
            font-weight: 600;
        }

        a {
            color: var(--primary);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        hr {
            border: none;
            border-top: 1px solid var(--border);
            margin: 2rem 0;
        }

        img {
            max-width: 600px;
            height: auto;
            border-radius: 0.5rem;
            border: 1px solid var(--border);
            margin: 1rem 0;
            display: block;
        }

        .mermaid {
            background: var(--bg-white);
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1.5rem 0;
            display: flex;
            justify-content: center;
            border: 1px solid var(--border);
            max-width: 800px;
            overflow-x: auto;
        }

        .mermaid svg {
            max-width: 100%;
            max-height: 500px;
            height: auto;
            transform: scale(0.85);
            transform-origin: top center;
        }

        @media (max-width: 1024px) {
            .sidebar {
                display: none;
            }

            .main-content {
                margin-left: 0;
                max-width: 100%;
            }

            .toc-sidebar {
                display: none;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';

        // Initialize Mermaid with enhanced configuration
        mermaid.initialize({
            startOnLoad: false,
            theme: 'default',
            themeVariables: {
                primaryColor: '#2563eb',
                primaryTextColor: '#0f172a',
                primaryBorderColor: '#1e40af',
                lineColor: '#64748b',
                secondaryColor: '#10b981',
                tertiaryColor: '#f59e0b',
                background: '#ffffff',
                mainBkg: '#f8fafc',
                secondBkg: '#e2e8f0',
                border1: '#cbd5e1',
                border2: '#94a3b8'
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            },
            sequence: {
                useMaxWidth: true,
                wrap: true
            },
            gantt: {
                useMaxWidth: true
            }
        });

        // Expose mermaid globally and signal it's ready
        window.mermaid = mermaid;
        window.mermaidReady = true;

        // Dispatch event when mermaid is ready
        window.dispatchEvent(new Event('mermaidLoaded'));
    </script>
</head>
<body>
    <aside class="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="back-link">‚Üê All Modules</a>
            <h1>SR</h1>
        </div>

        <nav>
            <div class="nav-section">
                <h3>Navigation</h3>
                <ul>
                    <li><a href="../index.html">Module Overview</a></li>
                    <li><a href="../index.html#features">Features</a></li>
                </ul>
            </div>
        </nav>
    </aside>

    <div class="main-content">
        <div class="breadcrumb"><a href="../index.html">Documentation</a> / <a href="../index.html">SR</a></div>

        <div class="content-wrapper">
            <div class="document-content" id="markdown-content"></div>

            <aside class="toc-sidebar">
                <div class="toc-sticky">
                    <div class="toc-title">On This Page</div>
                    <ul class="toc-list" id="toc-list"></ul>
                </div>
            </aside>
        </div>
    </div>

    <script>
        const markdownContent = "# Feature: Product Management and Catalog System\n\n## Description\nThe Carmen ERP Product Management System provides comprehensive product catalog management with sophisticated product profiling, multi-unit conversions, environmental impact tracking, location assignment management, and inventory integration. The system supports complex product configurations including pricing structures, tax management, unit conversions for ordering/inventory/recipes, location-specific parameters, and environmental sustainability metrics. Products can be configured for sale items, ingredients, or both, with complete lifecycle management from creation to discontinuation.\n\n## Process Flow (Step by Step)\n\n### Product Catalog Management\n1. User navigates to `/product-management/products` to access product catalog\n2. System displays product list with filtering by category, status, and search functionality\n3. User can create new products via \"Add Product\" button or edit existing products\n4. Product creation includes comprehensive tabs: General, Inventory, Order Units, Ingredient Units, Locations, Environmental Impact\n5. System validates product information including unique product codes and barcode verification\n6. Product profile setup includes category assignment, item group classification, and primary unit designation\n7. Advanced pricing configuration supports base price, standard cost, tax types, and deviation limits\n8. System maintains product relationships with vendors through pricing and procurement integration\n\n### Unit Conversion Management\n9. System supports three types of unit conversions: Inventory, Order, and Recipe units\n10. Conversion factors enable seamless unit transitions (e.g., KG to Grams, Liters to Bottles)\n11. Order units facilitate procurement processes with vendor-specific ordering units\n12. Recipe units enable recipe management with precise ingredient measurements\n13. System validates conversion factor accuracy and prevents circular conversion chains\n14. Bulk conversion updates support mass product unit changes\n\n### Location Assignment System\n15. Products can be assigned to multiple storage locations with specific parameters\n16. Location assignments include min/max quantities, reorder points, and par levels\n17. System tracks location-specific inventory levels and movement restrictions\n18. Assignment validation ensures logical min/max relationships and stock level constraints\n19. Bulk location assignment supports consistent parameter application across products\n20. Integration with inventory management provides real-time location-specific stock updates\n\n### Environmental Impact Tracking\n21. System captures comprehensive environmental metrics: carbon footprint, water usage, recyclability\n22. Sustainability certifications tracking includes Organic, Fair Trade, MSC, FSC certifications\n23. Energy efficiency ratings from A (most efficient) to F (least efficient) classification\n24. Biodegradability and packaging recyclability percentages for environmental compliance\n25. Environmental reports support sustainability initiatives and regulatory compliance\n26. Integration with procurement provides supplier environmental performance tracking\n\n### Category and Classification System\n27. Hierarchical category structure supports Category ‚Üí Subcategory ‚Üí Item Group organization\n28. Dynamic category management allows real-time classification updates\n29. Item groups enable cross-category product clustering (e.g., Organic Products, Premium Items)\n30. Classification affects reporting, pricing strategies, and procurement workflows\n31. Bulk reclassification supports organizational structure changes\n\n## Flow Diagram (Mermaid)\n```mermaid\nflowchart TD\n    A[Access Product Management] --> B[Product Catalog View]\n    B --> C{Action Required?}\n    C -->|Create New| D[New Product Form]\n    C -->|Edit Existing| E[Product Detail Page]\n    C -->|View Catalog| F[Filtered Product List]\n\n    D --> G[General Information Tab]\n    G --> H[Inventory Configuration Tab]\n    H --> I[Order Units Setup Tab]\n    I --> J[Ingredient Units Tab]\n    J --> K[Location Assignment Tab]\n    K --> L[Environmental Impact Tab]\n    L --> M[Save Product]\n\n    E --> N[Tabbed Detail Interface]\n    N --> O{Edit Mode?}\n    O -->|Yes| G\n    O -->|No| P[View Product Information]\n\n    M --> Q[Product Validation]\n    Q --> R{Validation Passed?}\n    R -->|Yes| S[Create Product Record]\n    R -->|No| T[Show Validation Errors]\n    T --> G\n\n    S --> U[Update Unit Conversions]\n    U --> V[Assign Locations]\n    V --> W[Generate Inventory Records]\n    W --> X[Integration Updates]\n\n    P --> Y[Unit Conversion Management]\n    Y --> Z[Add/Edit Conversions]\n    Z --> AA[Validate Conversion Factors]\n    AA --> BB[Update Unit Relationships]\n\n    F --> CC[Category Management]\n    CC --> DD[Category Hierarchy Updates]\n    DD --> EE[Product Reclassification]\n\n    X --> FF[Procurement Integration]\n    X --> GG[Inventory Integration]\n    X --> HH[Recipe Integration]\n    BB --> FF\n    EE --> II[Reporting Updates]\n```\n\n## Screen Capture Locations\n- Capture: Product catalog list with category filters and search functionality\n- Capture: New product creation form showing General tab with complete product information\n- Capture: Unit conversions setup showing inventory, order, and recipe unit relationships\n- Capture: Location assignment tab with min/max quantities and reorder points\n- Capture: Environmental impact tab with sustainability metrics and certifications\n- Capture: Product detail view with all tabs and comprehensive product information\n- Capture: Category management interface showing hierarchical structure\n- Capture: Bulk operations interface for mass product updates\n- Capture: Product integration with procurement showing vendor pricing associations\n\n## Schema Entities (Plain Text)\nProduct: Core product entity with productCode, name, description, localDescription, category hierarchy, primaryInventoryUnit, pricing, costs, deviationLimits, stockLevels, flags (isActive, isForSale, isIngredient), physicalAttributes (weight, shelfLife, size, color, barcode), and environmentalMetrics.\nUnitConversion: Unit relationship with productId, fromUnit, toUnit, conversionFactor, unitType (INVENTORY/ORDER/RECIPE), and validation rules.\nLocationAssignment: Product-location relationship with productId, locationId, minQuantity, maxQuantity, reorderPoint, parLevel, and status.\nProductCategory: Hierarchical classification with categoryId, name, parentCategory, subcategories, and itemGroups.\nEnvironmentalMetrics: Sustainability tracking with carbonFootprint, waterUsage, packagingRecyclability, biodegradabilityMonths, energyEfficiencyRating, and sustainableCertification.\nPricingConfiguration: Product pricing with basePrice, standardCost, lastCost, currency, taxType, taxRate, priceDeviationLimit, and quantityDeviationLimit.\n\n## Major Product Management Features\n\n### Product Catalog\n- **Comprehensive Profiling**: Complete product information including descriptions, categories, and classifications\n- **Multi-Language Support**: Local language descriptions for international operations\n- **Barcode Management**: Barcode generation and validation with duplicate checking\n- **Status Management**: Active/inactive status with workflow impact control\n- **Bulk Operations**: Mass updates for pricing, categories, and status changes\n\n### Unit Management System\n- **Multi-Unit Support**: Inventory, order, and recipe unit conversions\n- **Conversion Validation**: Mathematical validation and circular reference prevention\n- **Unit Relationships**: Complex conversion chains with accuracy verification\n- **Procurement Integration**: Seamless vendor ordering unit management\n- **Recipe Integration**: Precise ingredient measurement conversions\n\n### Advanced Pricing Configuration\n- **Flexible Pricing**: Base prices with standard and last cost tracking\n- **Tax Management**: Multiple tax types (Added, Included, None) with rate configuration\n- **Deviation Controls**: Price and quantity deviation limits for procurement control\n- **Cost Tracking**: Historical cost analysis and variance reporting\n- **Currency Support**: Multi-currency pricing with automatic conversion\n\n### Location-Based Management\n- **Multi-Location Assignment**: Products assigned to multiple storage locations\n- **Parameter Configuration**: Location-specific min/max quantities and reorder points\n- **Inventory Integration**: Real-time location-specific stock tracking\n- **Par Level Management**: Optimal stock level maintenance per location\n- **Transfer Management**: Inter-location transfer capability and tracking\n\n### Environmental Sustainability\n- **Carbon Footprint Tracking**: CO2 equivalent measurements per product unit\n- **Water Usage Monitoring**: Water consumption metrics for sustainability reporting\n- **Recyclability Assessment**: Packaging recyclability percentage tracking\n- **Certification Management**: Sustainability certification tracking and expiry monitoring\n- **Energy Efficiency**: Product energy efficiency rating and classification\n- **Biodegradability**: Natural decomposition timeframe tracking\n\n### Category and Classification\n- **Hierarchical Organization**: Category ‚Üí Subcategory ‚Üí Item Group structure\n- **Dynamic Classification**: Real-time category updates with workflow integration\n- **Cross-Category Grouping**: Item groups spanning multiple categories\n- **Reporting Integration**: Classification-based reporting and analytics\n- **Bulk Reclassification**: Mass category updates with validation\n\n## Ambiguities & Assumptions\nAssumption: Product codes must be unique across the entire system and cannot be reused even after product deletion.\nAssumption: Unit conversion factors are bidirectional and automatically calculate reverse conversions.\nAmbiguity: The specific business rules for automatic reorder point calculations based on historical consumption are not defined.\nAssumption: Environmental impact metrics are required for sustainability reporting and compliance tracking.\nAmbiguity: Integration timing with external systems (POS, e-commerce) for product catalog synchronization needs clarification.\nAssumption: Location assignments support both physical locations and virtual/logical location categories.\nAssumption: Tax configuration supports multi-jurisdiction tax rules with location-based tax rate determination.\nAmbiguity: The exact workflow for handling discontinued products and their impact on existing procurement/inventory processes requires specification.";

        // Configure marked
        marked.setOptions({
            highlight: function(code, lang) {
                return code;
            },
            breaks: true,
            gfm: true
        });

        // Render markdown
        const contentDiv = document.getElementById('markdown-content');
        contentDiv.innerHTML = marked.parse(markdownContent);

        // Function to render Mermaid diagrams
        function renderMermaidDiagrams() {
            if (!window.mermaid) {
                console.log('Mermaid not loaded yet, waiting...');
                return;
            }

            // Find all code blocks with mermaid language
            const mermaidBlocks = contentDiv.querySelectorAll('pre code.language-mermaid, pre code[class*="mermaid"]');

            if (mermaidBlocks.length === 0) {
                console.log('No mermaid blocks found');
                return;
            }

            console.log('Found', mermaidBlocks.length, 'mermaid blocks');

            mermaidBlocks.forEach((block, index) => {
                const mermaidCode = block.textContent;
                const pre = block.parentElement;

                // Create a div for mermaid diagram
                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = mermaidCode;
                mermaidDiv.id = 'mermaid-diagram-' + index;

                // Replace the pre block with mermaid div
                pre.replaceWith(mermaidDiv);
            });

            // Run mermaid rendering
            window.mermaid.run({
                querySelector: '.mermaid'
            }).then(() => {
                console.log('Mermaid diagrams rendered successfully');
            }).catch(err => {
                console.error('Mermaid rendering error:', err);
            });
        }

        // Wait for mermaid to load before rendering
        if (window.mermaidReady) {
            renderMermaidDiagrams();
        } else {
            window.addEventListener('mermaidLoaded', renderMermaidDiagrams);
            // Fallback timeout
            setTimeout(renderMermaidDiagrams, 1000);
        }

        // Generate TOC from headings
        const tocList = document.getElementById('toc-list');
        const headings = contentDiv.querySelectorAll('h2, h3, h4');

        headings.forEach((heading, index) => {
            const id = 'heading-' + index;
            heading.id = id;

            const li = document.createElement('li');
            const a = document.createElement('a');
            a.href = '#' + id;
            a.textContent = heading.textContent;
            a.className = 'toc-' + heading.tagName.toLowerCase();

            li.appendChild(a);
            tocList.appendChild(li);
        });

        // Highlight active TOC item on scroll
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const id = entry.target.id;
                    tocList.querySelectorAll('a').forEach(a => {
                        a.style.color = a.getAttribute('href') === '#' + id ? 'var(--primary)' : 'var(--text-secondary)';
                        a.style.fontWeight = a.getAttribute('href') === '#' + id ? '600' : '400';
                    });
                }
            });
        }, { threshold: 1.0 });

        headings.forEach(heading => observer.observe(heading));
    </script>
</body>
</html>