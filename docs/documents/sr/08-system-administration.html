<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature: System Administration - Carmen ERP Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --secondary: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg-light: #f8fafc;
            --bg-white: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: var(--bg-light);
            color: var(--text-primary);
            line-height: 1.6;
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background: var(--bg-white);
            border-right: 1px solid var(--border);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            padding: 2rem 0;
        }

        .sidebar-header {
            padding: 0 1.5rem;
            margin-bottom: 2rem;
        }

        .sidebar-header h1 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .back-link:hover {
            color: var(--primary);
        }

        .sidebar nav {
            padding: 0 1rem;
        }

        .nav-section {
            margin-bottom: 1.5rem;
        }

        .nav-section h3 {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            padding: 0 0.5rem;
            margin-bottom: 0.5rem;
        }

        .nav-section ul {
            list-style: none;
        }

        .nav-section a {
            display: block;
            padding: 0.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .nav-section a:hover,
        .nav-section a.active {
            background: var(--bg-light);
            color: var(--primary);
        }

        .main-content {
            margin-left: 280px;
            flex: 1;
            padding: 2rem;
            max-width: calc(100% - 280px);
        }

        .breadcrumb {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .breadcrumb a {
            color: var(--primary);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .content-wrapper {
            display: flex;
            gap: 2rem;
        }

        .document-content {
            flex: 1;
            background: var(--bg-white);
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
            min-width: 0;
        }

        .toc-sidebar {
            width: 250px;
            flex-shrink: 0;
        }

        .toc-sticky {
            position: sticky;
            top: 2rem;
            background: var(--bg-white);
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
        }

        .toc-title {
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .toc-list {
            list-style: none;
        }

        .toc-list a {
            display: block;
            padding: 0.25rem 0;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            transition: color 0.2s;
        }

        .toc-list a:hover {
            color: var(--primary);
        }

        .toc-list .toc-h2 {
            margin-left: 0;
            font-weight: 500;
        }

        .toc-list .toc-h3 {
            margin-left: 1rem;
            font-size: 0.8125rem;
        }

        .toc-list .toc-h4 {
            margin-left: 2rem;
            font-size: 0.75rem;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        h2 {
            font-size: 1.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border);
            color: var(--text-primary);
        }

        h3 {
            font-size: 1.25rem;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        h4 {
            font-size: 1.125rem;
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        p {
            margin-bottom: 1rem;
        }

        ul, ol {
            margin-bottom: 1rem;
            padding-left: 2rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        code {
            background: var(--bg-light);
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.875rem;
        }

        pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin-bottom: 1rem;
        }

        pre code {
            background: transparent;
            padding: 0;
            color: inherit;
        }

        blockquote {
            border-left: 4px solid var(--primary);
            padding-left: 1rem;
            margin: 1rem 0;
            color: var(--text-secondary);
            font-style: italic;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
        }

        th, td {
            border: 1px solid var(--border);
            padding: 0.75rem;
            text-align: left;
        }

        th {
            background: var(--bg-light);
            font-weight: 600;
        }

        a {
            color: var(--primary);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        hr {
            border: none;
            border-top: 1px solid var(--border);
            margin: 2rem 0;
        }

        img {
            max-width: 600px;
            height: auto;
            border-radius: 0.5rem;
            border: 1px solid var(--border);
            margin: 1rem 0;
            display: block;
        }

        .mermaid {
            background: var(--bg-white);
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1.5rem 0;
            display: flex;
            justify-content: center;
            border: 1px solid var(--border);
            max-width: 800px;
            overflow-x: auto;
        }

        .mermaid svg {
            max-width: 100%;
            max-height: 500px;
            height: auto;
            transform: scale(0.85);
            transform-origin: top center;
        }

        @media (max-width: 1024px) {
            .sidebar {
                display: none;
            }

            .main-content {
                margin-left: 0;
                max-width: 100%;
            }

            .toc-sidebar {
                display: none;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';

        // Initialize Mermaid with enhanced configuration
        mermaid.initialize({
            startOnLoad: false,
            theme: 'default',
            themeVariables: {
                primaryColor: '#2563eb',
                primaryTextColor: '#0f172a',
                primaryBorderColor: '#1e40af',
                lineColor: '#64748b',
                secondaryColor: '#10b981',
                tertiaryColor: '#f59e0b',
                background: '#ffffff',
                mainBkg: '#f8fafc',
                secondBkg: '#e2e8f0',
                border1: '#cbd5e1',
                border2: '#94a3b8'
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            },
            sequence: {
                useMaxWidth: true,
                wrap: true
            },
            gantt: {
                useMaxWidth: true
            }
        });

        // Expose mermaid globally and signal it's ready
        window.mermaid = mermaid;
        window.mermaidReady = true;

        // Dispatch event when mermaid is ready
        window.dispatchEvent(new Event('mermaidLoaded'));
    </script>
</head>
<body>
    <aside class="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="back-link">‚Üê All Modules</a>
            <h1>SR</h1>
        </div>

        <nav>
            <div class="nav-section">
                <h3>Navigation</h3>
                <ul>
                    <li><a href="../index.html">Module Overview</a></li>
                    <li><a href="../index.html#features">Features</a></li>
                </ul>
            </div>
        </nav>
    </aside>

    <div class="main-content">
        <div class="breadcrumb"><a href="../index.html">Documentation</a> / <a href="../index.html">SR</a></div>

        <div class="content-wrapper">
            <div class="document-content" id="markdown-content"></div>

            <aside class="toc-sidebar">
                <div class="toc-sticky">
                    <div class="toc-title">On This Page</div>
                    <ul class="toc-list" id="toc-list"></ul>
                </div>
            </aside>
        </div>
    </div>

    <script>
        const markdownContent = "# Feature: System Administration\n\n## Description\nThe Carmen ERP System Administration module provides comprehensive system management capabilities including user management, permission management, workflow configuration, location management, system integrations (particularly POS integration), and business rule configuration. The system features advanced role-based policy management, sophisticated workflow engines, location hierarchy management, and extensive integration capabilities. System administration supports both simple and complex organizational structures with scalable permission models and workflow configurations.\n\n## Process Flow (Step by Step)\n\n### User Management\n1. User navigates to `/system-administration/user-management` to access user administration\n2. System displays user list with filtering by role, department, status, and search functionality\n3. Administrator can create new users, edit existing profiles, or manage user assignments\n4. User creation includes personal information, role assignments, department access, and location permissions\n5. Bulk user operations support mass role updates, status changes, and permission assignments\n6. User activity monitoring provides audit trails and access tracking\n7. User lifecycle management handles activation, deactivation, and profile archival\n\n### Permission Management\n8. Administrator accesses `/system-administration/permission-management` for advanced permission control\n9. Policy Management allows creation of custom access policies with complex business rules\n10. Role Management provides hierarchical role definition with permission inheritance\n11. Subscription Settings manage feature access based on licensing and subscription levels\n12. Policy Builder enables visual policy creation with conditional logic and rule testing\n13. Permission assignment supports both individual user and group-based permissions\n14. Policy validation ensures conflict resolution and logical consistency\n\n### Workflow Configuration\n15. Workflow Management accessible via `/system-administration/workflow/workflow-configuration`\n16. Workflow designer allows creation of approval workflows with multiple stages and routing\n17. Role Assignment component manages approver assignments based on organizational hierarchy\n18. Conditional routing supports complex approval logic based on amounts, departments, and request types\n19. Workflow templates provide standardized approval processes across different document types\n20. Escalation management handles overdue approvals with automatic escalation rules\n\n### Location Management\n21. Location hierarchy managed through `/system-administration/location-management`\n22. Location creation includes physical address, operational parameters, and parent-child relationships\n23. Location types support warehouses, stores, kitchens, offices, and virtual locations\n24. Location assignments affect inventory visibility, user access, and operational scope\n25. Location-specific configurations include currency, time zones, and local regulations\n26. Bulk location operations support organizational restructuring and mass updates\n\n### System Integrations\n27. POS Integration accessible via `/system-administration/system-integrations/pos`\n28. Integration dashboard provides real-time status monitoring and configuration management\n29. Data mapping between Carmen ERP and POS systems for products, units, locations, and recipes\n30. Transaction synchronization with bi-directional data flow and conflict resolution\n31. Settings management for API endpoints, authentication, and data transformation rules\n32. Integration monitoring with error logging, retry mechanisms, and failure alerts\n\n## Flow Diagram (Mermaid)\n```mermaid\nflowchart TD\n    A[Access System Administration] --> B{Administration Function?}\n\n    B -->|User Management| C[User Administration]\n    C --> D[User List Management]\n    D --> E[Create/Edit Users]\n    E --> F[Role Assignment]\n    F --> G[Department Assignment]\n    G --> H[Location Assignment]\n    H --> I[User Activation]\n\n    B -->|Permission Management| J[Permission Administration]\n    J --> K[Policy Management]\n    K --> L[Role Management]\n    L --> M[Subscription Settings]\n    M --> N[Policy Builder]\n    N --> O[Permission Testing]\n\n    B -->|Workflow Configuration| P[Workflow Management]\n    P --> Q[Workflow Designer]\n    Q --> R[Stage Configuration]\n    R --> S[Approver Assignment]\n    S --> T[Conditional Routing]\n    T --> U[Workflow Testing]\n\n    B -->|Location Management| V[Location Administration]\n    V --> W[Location Hierarchy]\n    W --> X[Location Creation]\n    X --> Y[Parameter Configuration]\n    Y --> Z[Location Assignment]\n\n    B -->|System Integration| AA[Integration Management]\n    AA --> BB[POS Integration]\n    BB --> CC[Data Mapping]\n    CC --> DD[Transaction Sync]\n    DD --> EE[Monitoring & Alerts]\n\n    I --> FF[User Validation]\n    O --> GG[Policy Validation]\n    U --> HH[Workflow Validation]\n    Z --> II[Location Validation]\n    EE --> JJ[Integration Validation]\n\n    FF --> KK[Apply Changes]\n    GG --> KK\n    HH --> KK\n    II --> KK\n    JJ --> KK\n\n    KK --> LL[System Updates]\n    LL --> MM[Notification Distribution]\n    MM --> NN[Audit Logging]\n    NN --> OO[Configuration Backup]\n```\n\n## Screen Capture Locations\n- Capture: User management list with bulk operations and filtering capabilities\n- Capture: User creation form with role, department, and location assignments\n- Capture: Permission management dashboard with policy and role configuration\n- Capture: Policy builder interface showing visual rule creation\n- Capture: Workflow configuration designer with approval stages and routing\n- Capture: Location management hierarchy with parent-child relationships\n- Capture: POS integration dashboard with real-time status monitoring\n- Capture: System integration mapping interface for data transformation\n- Capture: Permission testing interface with validation results\n\n## Schema Entities (Plain Text)\nSystemUser: User entity with id, personalInfo, roles, departments, locations, permissions, status, preferences, and auditLog.\nPermission: Granular permission with resource, action, conditions, scope, and inheritance rules.\nPolicy: Complex access policy with conditions, rules, exceptions, and business logic.\nWorkflowDefinition: Workflow template with stages, approvers, conditions, routing rules, and escalation settings.\nLocation: Physical/logical location with hierarchy, address, parameters, assignments, and operational settings.\nIntegration: System integration with connectionDetails, mappings, synchronizationRules, monitoring, and errorHandling.\nRole: System role with permissions, hierarchy, description, and assignment rules.\n\n## Major System Administration Features\n\n### User Management System\n- **Comprehensive User Profiles**: Complete user information with multi-dimensional assignments\n- **Bulk Operations**: Mass user updates, role assignments, and status changes\n- **User Lifecycle Management**: Account creation, activation, deactivation, and archival processes\n- **Access Monitoring**: Real-time user activity tracking and audit trail maintenance\n- **Self-Service Capabilities**: User profile updates and preference management\n- **Integration Ready**: Support for external authentication systems and directory services\n\n### Advanced Permission Management\n- **Policy-Based Access Control**: Sophisticated policy engine with conditional logic\n- **Visual Policy Builder**: Graphical interface for creating complex access rules\n- **Role Hierarchy**: Multi-level role inheritance with permission cascading\n- **Subscription Management**: Feature access control based on licensing tiers\n- **Permission Testing**: Validation and testing environment for policy verification\n- **Audit Compliance**: Complete permission change tracking and compliance reporting\n\n### Workflow Configuration Engine\n- **Visual Workflow Designer**: Drag-and-drop workflow creation with stage management\n- **Dynamic Approver Assignment**: Rule-based approver selection with organizational hierarchy\n- **Conditional Routing**: Complex routing logic based on document attributes and business rules\n- **Escalation Management**: Automatic escalation with time-based and condition-based triggers\n- **Workflow Templates**: Reusable workflow patterns for consistent approval processes\n- **Performance Monitoring**: Workflow efficiency tracking and bottleneck identification\n\n### Location Management System\n- **Hierarchical Structure**: Multi-level location organization with parent-child relationships\n- **Location Types**: Support for warehouses, stores, offices, kitchens, and virtual locations\n- **Operational Parameters**: Location-specific settings for currency, time zones, and regulations\n- **Assignment Management**: User and resource assignment to locations with access control\n- **Bulk Operations**: Mass location updates and organizational restructuring support\n- **Integration Support**: Location data synchronization with external systems\n\n### System Integration Platform\n- **POS Integration**: Comprehensive point-of-sale system integration with bi-directional sync\n- **Data Mapping Engine**: Flexible data transformation and mapping capabilities\n- **Real-Time Monitoring**: Integration health monitoring with alerting and notification\n- **Error Handling**: Robust error detection, logging, and automatic retry mechanisms\n- **API Management**: RESTful API endpoints for external system integration\n- **Scalable Architecture**: Support for multiple concurrent integrations and high-volume data processing\n\n### Business Rules and Configuration\n- **Rule Engine**: Flexible business rule configuration with validation and testing\n- **Configuration Management**: Centralized system configuration with version control\n- **Template System**: Reusable configuration templates for consistent setup\n- **Compliance Monitoring**: Regulatory compliance tracking and reporting capabilities\n- **Change Management**: Controlled configuration changes with approval workflows\n- **Backup and Recovery**: Automated configuration backup and disaster recovery procedures\n\n## Ambiguities & Assumptions\nAssumption: System administration requires elevated privileges and operates under enhanced security protocols.\nAssumption: Workflow configurations are validated before activation to prevent system disruptions.\nAmbiguity: The specific integration protocols and data formats supported by the POS integration system require detailed specification.\nAssumption: Location hierarchy supports unlimited levels of nesting with circular reference prevention.\nAmbiguity: The exact permission inheritance rules and conflict resolution mechanisms in complex role hierarchies need clarification.\nAssumption: All system configuration changes are logged and can be rolled back if necessary.\nAssumption: Integration monitoring includes performance metrics, error rates, and data quality assessments.\nAmbiguity: The specific business rules engine capabilities and rule syntax supported by the system require detailed documentation.";

        // Configure marked
        marked.setOptions({
            highlight: function(code, lang) {
                return code;
            },
            breaks: true,
            gfm: true
        });

        // Render markdown
        const contentDiv = document.getElementById('markdown-content');
        contentDiv.innerHTML = marked.parse(markdownContent);

        // Function to render Mermaid diagrams
        function renderMermaidDiagrams() {
            if (!window.mermaid) {
                console.log('Mermaid not loaded yet, waiting...');
                return;
            }

            // Find all code blocks with mermaid language
            const mermaidBlocks = contentDiv.querySelectorAll('pre code.language-mermaid, pre code[class*="mermaid"]');

            if (mermaidBlocks.length === 0) {
                console.log('No mermaid blocks found');
                return;
            }

            console.log('Found', mermaidBlocks.length, 'mermaid blocks');

            mermaidBlocks.forEach((block, index) => {
                const mermaidCode = block.textContent;
                const pre = block.parentElement;

                // Create a div for mermaid diagram
                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = mermaidCode;
                mermaidDiv.id = 'mermaid-diagram-' + index;

                // Replace the pre block with mermaid div
                pre.replaceWith(mermaidDiv);
            });

            // Run mermaid rendering
            window.mermaid.run({
                querySelector: '.mermaid'
            }).then(() => {
                console.log('Mermaid diagrams rendered successfully');
            }).catch(err => {
                console.error('Mermaid rendering error:', err);
            });
        }

        // Wait for mermaid to load before rendering
        if (window.mermaidReady) {
            renderMermaidDiagrams();
        } else {
            window.addEventListener('mermaidLoaded', renderMermaidDiagrams);
            // Fallback timeout
            setTimeout(renderMermaidDiagrams, 1000);
        }

        // Generate TOC from headings
        const tocList = document.getElementById('toc-list');
        const headings = contentDiv.querySelectorAll('h2, h3, h4');

        headings.forEach((heading, index) => {
            const id = 'heading-' + index;
            heading.id = id;

            const li = document.createElement('li');
            const a = document.createElement('a');
            a.href = '#' + id;
            a.textContent = heading.textContent;
            a.className = 'toc-' + heading.tagName.toLowerCase();

            li.appendChild(a);
            tocList.appendChild(li);
        });

        // Highlight active TOC item on scroll
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const id = entry.target.id;
                    tocList.querySelectorAll('a').forEach(a => {
                        a.style.color = a.getAttribute('href') === '#' + id ? 'var(--primary)' : 'var(--text-secondary)';
                        a.style.fontWeight = a.getAttribute('href') === '#' + id ? '600' : '400';
                    });
                }
            });
        }, { threshold: 1.0 });

        headings.forEach(heading => observer.observe(heading));
    </script>
</body>
</html>