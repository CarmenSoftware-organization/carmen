<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Store Operations Module - Carmen ERP Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --secondary: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg-light: #f8fafc;
            --bg-white: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: var(--bg-light);
            color: var(--text-primary);
            line-height: 1.6;
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background: var(--bg-white);
            border-right: 1px solid var(--border);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            padding: 2rem 0;
        }

        .sidebar-header {
            padding: 0 1.5rem;
            margin-bottom: 2rem;
        }

        .sidebar-header h1 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .back-link:hover {
            color: var(--primary);
        }

        .sidebar nav {
            padding: 0 1rem;
        }

        .nav-section {
            margin-bottom: 1.5rem;
        }

        .nav-section h3 {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            padding: 0 0.5rem;
            margin-bottom: 0.5rem;
        }

        .nav-section ul {
            list-style: none;
        }

        .nav-section a {
            display: block;
            padding: 0.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .nav-section a:hover,
        .nav-section a.active {
            background: var(--bg-light);
            color: var(--primary);
        }

        .main-content {
            margin-left: 280px;
            flex: 1;
            padding: 2rem;
            max-width: calc(100% - 280px);
        }

        .breadcrumb {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .breadcrumb a {
            color: var(--primary);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .content-wrapper {
            display: flex;
            gap: 2rem;
        }

        .document-content {
            flex: 1;
            background: var(--bg-white);
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
            min-width: 0;
        }

        .toc-sidebar {
            width: 250px;
            flex-shrink: 0;
        }

        .toc-sticky {
            position: sticky;
            top: 2rem;
            background: var(--bg-white);
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
        }

        .toc-title {
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .toc-list {
            list-style: none;
        }

        .toc-list a {
            display: block;
            padding: 0.25rem 0;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            transition: color 0.2s;
        }

        .toc-list a:hover {
            color: var(--primary);
        }

        .toc-list .toc-h2 {
            margin-left: 0;
            font-weight: 500;
        }

        .toc-list .toc-h3 {
            margin-left: 1rem;
            font-size: 0.8125rem;
        }

        .toc-list .toc-h4 {
            margin-left: 2rem;
            font-size: 0.75rem;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        h2 {
            font-size: 1.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border);
            color: var(--text-primary);
        }

        h3 {
            font-size: 1.25rem;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        h4 {
            font-size: 1.125rem;
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        p {
            margin-bottom: 1rem;
        }

        ul, ol {
            margin-bottom: 1rem;
            padding-left: 2rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        code {
            background: var(--bg-light);
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.875rem;
        }

        pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin-bottom: 1rem;
        }

        pre code {
            background: transparent;
            padding: 0;
            color: inherit;
        }

        blockquote {
            border-left: 4px solid var(--primary);
            padding-left: 1rem;
            margin: 1rem 0;
            color: var(--text-secondary);
            font-style: italic;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
        }

        th, td {
            border: 1px solid var(--border);
            padding: 0.75rem;
            text-align: left;
        }

        th {
            background: var(--bg-light);
            font-weight: 600;
        }

        a {
            color: var(--primary);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        hr {
            border: none;
            border-top: 1px solid var(--border);
            margin: 2rem 0;
        }

        img {
            max-width: 600px;
            height: auto;
            border-radius: 0.5rem;
            border: 1px solid var(--border);
            margin: 1rem 0;
            display: block;
        }

        .mermaid {
            background: var(--bg-white);
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1.5rem 0;
            display: flex;
            justify-content: center;
            border: 1px solid var(--border);
            max-width: 800px;
            overflow-x: auto;
        }

        .mermaid svg {
            max-width: 100%;
            max-height: 500px;
            height: auto;
            transform: scale(0.85);
            transform-origin: top center;
        }

        @media (max-width: 1024px) {
            .sidebar {
                display: none;
            }

            .main-content {
                margin-left: 0;
                max-width: 100%;
            }

            .toc-sidebar {
                display: none;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';

        // Initialize Mermaid with enhanced configuration
        mermaid.initialize({
            startOnLoad: false,
            theme: 'default',
            themeVariables: {
                primaryColor: '#2563eb',
                primaryTextColor: '#0f172a',
                primaryBorderColor: '#1e40af',
                lineColor: '#64748b',
                secondaryColor: '#10b981',
                tertiaryColor: '#f59e0b',
                background: '#ffffff',
                mainBkg: '#f8fafc',
                secondBkg: '#e2e8f0',
                border1: '#cbd5e1',
                border2: '#94a3b8'
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            },
            sequence: {
                useMaxWidth: true,
                wrap: true
            },
            gantt: {
                useMaxWidth: true
            }
        });

        // Expose mermaid globally and signal it's ready
        window.mermaid = mermaid;
        window.mermaidReady = true;

        // Dispatch event when mermaid is ready
        window.dispatchEvent(new Event('mermaidLoaded'));
    </script>
</head>
<body>
    <aside class="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="back-link">‚Üê All Modules</a>
            <h1>Store Operations</h1>
        </div>

        <nav>
            <div class="nav-section">
                <h3>Navigation</h3>
                <ul>
                    <li><a href="../index.html">Module Overview</a></li>
                    <li><a href="../index.html#features">Features</a></li>
                </ul>
            </div>
        </nav>
    </aside>

    <div class="main-content">
        <div class="breadcrumb"><a href="../index.html">Documentation</a> / <a href="../index.html">STORE-OPS</a></div>

        <div class="content-wrapper">
            <div class="document-content" id="markdown-content"></div>

            <aside class="toc-sidebar">
                <div class="toc-sticky">
                    <div class="toc-title">On This Page</div>
                    <ul class="toc-list" id="toc-list"></ul>
                </div>
            </aside>
        </div>
    </div>

    <script>
        const markdownContent = "# Store Operations Module\n\n**Module**: Store Operations\n**Route**: `/store-operations`\n**Status**: ‚úÖ Production (Store Requisitions), üöß Prototype (Stock Replenishment, Wastage Reporting)\n**Last Updated**: 2025-10-02\n\n## Table of Contents\n\n- [Overview](#overview)\n- [Module Sitemap](#module-sitemap)\n- [Submodules](#submodules)\n- [Key Features](#key-features)\n- [Module Statistics](#module-statistics)\n- [Related Documentation](#related-documentation)\n\n## Overview\n\nThe Store Operations module manages day-to-day store activities including store requisitions, stock replenishment, and wastage reporting. It provides comprehensive tools for tracking inventory movements between locations, managing stock levels, and monitoring wastage across all stores and operational units.\n\n**Primary Functions**:\n- Store-to-store requisition management\n- Stock replenishment tracking and alerts\n- Wastage reporting and analysis\n- Inventory movement tracking\n- Approval workflows for requisitions\n\n## Module Sitemap\n\n```mermaid\ngraph TD\n    SO[\"Store Operations Dashboard<br/>/store-operations\"]\n\n    %% Submodules\n    SR[\"Store Requisitions<br/>/store-operations/store-requisitions\"]\n    STOCK[\"Stock Replenishment<br/>/store-operations/stock-replenishment\"]\n    WASTE[\"Wastage Reporting<br/>/store-operations/wastage-reporting\"]\n\n    %% Store Requisitions Pages\n    SR_LIST[\"SR List Page<br/>/store-operations/store-requisitions\"]\n    SR_DETAIL[\"SR Detail Page<br/>/store-operations/store-requisitions/SR-XXXX-XXX\"]\n\n    %% Connections\n    SO --> SR\n    SO --> STOCK\n    SO --> WASTE\n\n    SR --> SR_LIST\n    SR_LIST --> SR_DETAIL\n\n    %% Styling\n    classDef production fill:#22c55e,stroke:#16a34a,color:#fff\n    classDef prototype fill:#f59e0b,stroke:#d97706,color:#fff\n    classDef dashboard fill:#3b82f6,stroke:#2563eb,color:#fff\n\n    class SO dashboard\n    class SR,SR_LIST,SR_DETAIL production\n    class STOCK,WASTE prototype\n```\n\n## Submodules\n\n### 1. Store Requisitions\n**Route**: `/store-operations/store-requisitions`\n**Status**: ‚úÖ Production\n**Purpose**: Manage store-to-store material requisitions with approval workflows\n**Documentation**: [STORE-REQUISITIONS.md](STORE-REQUISITIONS.md)\n\n**Key Pages**:\n- Store Requisition List Page (with filters, search, table/card views)\n- Store Requisition Detail Page (with tabs: Items, Comments, Attachments, Activity Log, Journal Entries)\n- Approval Workflow Component\n\n**Features**:\n- Create and manage requisitions\n- Multi-level approval workflow (HOD ‚Üí Store Manager)\n- Item-level approval/rejection\n- Stock movement tracking\n- Journal entry generation\n- Comments and attachments\n- Activity logging\n\n### 2. Stock Replenishment\n**Route**: `/store-operations/stock-replenishment`\n**Status**: üöß Prototype\n**Purpose**: Monitor and manage stock replenishment needs across stores\n**Documentation**: [STOCK-REPLENISHMENT.md](STOCK-REPLENISHMENT.md)\n\n**Key Features**:\n- Stock level monitoring\n- Low stock alerts\n- Reorder point tracking\n- Par level management\n- Automated requisition creation\n\n### 3. Wastage Reporting\n**Route**: `/store-operations/wastage-reporting`\n**Status**: üöß Prototype\n**Purpose**: Track and analyze wastage across all operational units\n**Documentation**: [WASTAGE-REPORTING.md](WASTAGE-REPORTING.md)\n\n**Key Features**:\n- Wastage entry recording\n- Wastage categorization (Expiration, Damage, Quality Issues, Other)\n- Monthly trend analysis\n- Wastage by reason breakdown\n- Cost impact tracking\n\n## Key Features\n\n### Store Requisition Management\n- **Requisition Workflow**: Draft ‚Üí Submission ‚Üí HOD Approval ‚Üí Store Manager Approval ‚Üí Complete\n- **Multi-Level Approvals**: Configurable approval workflow with role-based stages\n- **Item-Level Control**: Approve/reject individual items within a requisition\n- **Stock Tracking**: Real-time inventory updates upon approval\n- **Document Management**: Attach supporting documents and add comments\n\n### Stock Monitoring\n- **Real-Time Alerts**: Low stock notifications based on reorder points\n- **Par Level Management**: Maintain optimal stock levels per location\n- **Usage Tracking**: Monitor consumption patterns\n- **Automated Reordering**: Create requisitions from stock alerts\n\n### Wastage Control\n- **Reason Tracking**: Categorize wastage by cause\n- **Cost Analysis**: Calculate financial impact of wastage\n- **Trend Monitoring**: Identify wastage patterns over time\n- **Approval Process**: Review and approve wastage entries\n\n## Module Statistics\n\n### Store Requisitions (Production)\n- **Total Requisitions**: 15 sample records\n- **Status Distribution**:\n  - In Process: 40%\n  - Complete: 33%\n  - Draft: 20%\n  - Reject: 7%\n  - Void: 0%\n- **Approval Stages**: 4 (Submission, HOD, Store Manager, Complete)\n- **Average Items per Requisition**: 7 items\n\n### Stock Replenishment (Prototype)\n- **Total SKUs**: 1,234\n- **Low Stock Items**: 28\n- **Items on Order**: 45\n- **Total Stock Value**: $45,678\n\n### Wastage Reporting (Prototype)\n- **Monthly Wastage**: $3,458.50\n- **Items Written Off**: 45\n- **Pending Reviews**: 12\n- **Wastage Reasons**: 4 categories\n\n## Related Documentation\n\n### Submodule Documentation\n1. **[STORE-REQUISITIONS.md](STORE-REQUISITIONS.md)** - Complete store requisitions specification\n2. **[STOCK-REPLENISHMENT.md](STOCK-REPLENISHMENT.md)** - Stock replenishment dashboard (prototype)\n3. **[WASTAGE-REPORTING.md](WASTAGE-REPORTING.md)** - Wastage reporting dashboard (prototype)\n\n### Supporting Documentation\n- **[SHARED-COMPONENTS.md](SHARED-COMPONENTS.md)** - Reusable UI components\n- **[FEATURE-GAPS.md](FEATURE-GAPS.md)** - Incomplete features and future development\n\n### Related Modules\n- **Inventory Management** - Stock tracking and movements\n- **Procurement** - Purchase orders and vendor management\n- **Finance** - Journal entries and cost tracking\n\n---\n\n**Module Version**: 1.0.0 (Store Requisitions), 0.5.0 (Stock Replenishment, Wastage Reporting)\n**Documentation Status**: In Progress\n";

        // Configure marked
        marked.setOptions({
            highlight: function(code, lang) {
                return code;
            },
            breaks: true,
            gfm: true
        });

        // Render markdown
        const contentDiv = document.getElementById('markdown-content');
        contentDiv.innerHTML = marked.parse(markdownContent);

        // Function to render Mermaid diagrams
        function renderMermaidDiagrams() {
            if (!window.mermaid) {
                console.log('Mermaid not loaded yet, waiting...');
                return;
            }

            // Find all code blocks with mermaid language
            const mermaidBlocks = contentDiv.querySelectorAll('pre code.language-mermaid, pre code[class*="mermaid"]');

            if (mermaidBlocks.length === 0) {
                console.log('No mermaid blocks found');
                return;
            }

            console.log('Found', mermaidBlocks.length, 'mermaid blocks');

            mermaidBlocks.forEach((block, index) => {
                const mermaidCode = block.textContent;
                const pre = block.parentElement;

                // Create a div for mermaid diagram
                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = mermaidCode;
                mermaidDiv.id = 'mermaid-diagram-' + index;

                // Replace the pre block with mermaid div
                pre.replaceWith(mermaidDiv);
            });

            // Run mermaid rendering
            window.mermaid.run({
                querySelector: '.mermaid'
            }).then(() => {
                console.log('Mermaid diagrams rendered successfully');
            }).catch(err => {
                console.error('Mermaid rendering error:', err);
            });
        }

        // Wait for mermaid to load before rendering
        if (window.mermaidReady) {
            renderMermaidDiagrams();
        } else {
            window.addEventListener('mermaidLoaded', renderMermaidDiagrams);
            // Fallback timeout
            setTimeout(renderMermaidDiagrams, 1000);
        }

        // Generate TOC from headings
        const tocList = document.getElementById('toc-list');
        const headings = contentDiv.querySelectorAll('h2, h3, h4');

        headings.forEach((heading, index) => {
            const id = 'heading-' + index;
            heading.id = id;

            const li = document.createElement('li');
            const a = document.createElement('a');
            a.href = '#' + id;
            a.textContent = heading.textContent;
            a.className = 'toc-' + heading.tagName.toLowerCase();

            li.appendChild(a);
            tocList.appendChild(li);
        });

        // Highlight active TOC item on scroll
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const id = entry.target.id;
                    tocList.querySelectorAll('a').forEach(a => {
                        a.style.color = a.getAttribute('href') === '#' + id ? 'var(--primary)' : 'var(--text-secondary)';
                        a.style.fontWeight = a.getAttribute('href') === '#' + id ? '600' : '400';
                    });
                }
            });
        }, { threshold: 1.0 });

        headings.forEach(heading => observer.observe(heading));
    </script>
</body>
</html>