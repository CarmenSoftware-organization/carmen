<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Store Operations Module - Complete Specification - Carmen ERP Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --secondary: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg-light: #f8fafc;
            --bg-white: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: var(--bg-light);
            color: var(--text-primary);
            line-height: 1.6;
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background: var(--bg-white);
            border-right: 1px solid var(--border);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            padding: 2rem 0;
        }

        .sidebar-header {
            padding: 0 1.5rem;
            margin-bottom: 2rem;
        }

        .sidebar-header h1 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .back-link:hover {
            color: var(--primary);
        }

        .sidebar nav {
            padding: 0 1rem;
        }

        .nav-section {
            margin-bottom: 1.5rem;
        }

        .nav-section h3 {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            padding: 0 0.5rem;
            margin-bottom: 0.5rem;
        }

        .nav-section ul {
            list-style: none;
        }

        .nav-section a {
            display: block;
            padding: 0.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .nav-section a:hover,
        .nav-section a.active {
            background: var(--bg-light);
            color: var(--primary);
        }

        .main-content {
            margin-left: 280px;
            flex: 1;
            padding: 2rem;
            max-width: calc(100% - 280px);
        }

        .breadcrumb {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .breadcrumb a {
            color: var(--primary);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .content-wrapper {
            display: flex;
            gap: 2rem;
        }

        .document-content {
            flex: 1;
            background: var(--bg-white);
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
            min-width: 0;
        }

        .toc-sidebar {
            width: 250px;
            flex-shrink: 0;
        }

        .toc-sticky {
            position: sticky;
            top: 2rem;
            background: var(--bg-white);
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
        }

        .toc-title {
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .toc-list {
            list-style: none;
        }

        .toc-list a {
            display: block;
            padding: 0.25rem 0;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            transition: color 0.2s;
        }

        .toc-list a:hover {
            color: var(--primary);
        }

        .toc-list .toc-h2 {
            margin-left: 0;
            font-weight: 500;
        }

        .toc-list .toc-h3 {
            margin-left: 1rem;
            font-size: 0.8125rem;
        }

        .toc-list .toc-h4 {
            margin-left: 2rem;
            font-size: 0.75rem;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        h2 {
            font-size: 1.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border);
            color: var(--text-primary);
        }

        h3 {
            font-size: 1.25rem;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        h4 {
            font-size: 1.125rem;
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        p {
            margin-bottom: 1rem;
        }

        ul, ol {
            margin-bottom: 1rem;
            padding-left: 2rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        code {
            background: var(--bg-light);
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.875rem;
        }

        pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin-bottom: 1rem;
        }

        pre code {
            background: transparent;
            padding: 0;
            color: inherit;
        }

        blockquote {
            border-left: 4px solid var(--primary);
            padding-left: 1rem;
            margin: 1rem 0;
            color: var(--text-secondary);
            font-style: italic;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
        }

        th, td {
            border: 1px solid var(--border);
            padding: 0.75rem;
            text-align: left;
        }

        th {
            background: var(--bg-light);
            font-weight: 600;
        }

        a {
            color: var(--primary);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        hr {
            border: none;
            border-top: 1px solid var(--border);
            margin: 2rem 0;
        }

        img {
            max-width: 600px;
            height: auto;
            border-radius: 0.5rem;
            border: 1px solid var(--border);
            margin: 1rem 0;
            display: block;
        }

        .mermaid {
            background: var(--bg-white);
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1.5rem 0;
            display: flex;
            justify-content: center;
            border: 1px solid var(--border);
            max-width: 800px;
            overflow-x: auto;
        }

        .mermaid svg {
            max-width: 100%;
            max-height: 500px;
            height: auto;
            transform: scale(0.85);
            transform-origin: top center;
        }

        @media (max-width: 1024px) {
            .sidebar {
                display: none;
            }

            .main-content {
                margin-left: 0;
                max-width: 100%;
            }

            .toc-sidebar {
                display: none;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';

        // Initialize Mermaid with enhanced configuration
        mermaid.initialize({
            startOnLoad: false,
            theme: 'default',
            themeVariables: {
                primaryColor: '#2563eb',
                primaryTextColor: '#0f172a',
                primaryBorderColor: '#1e40af',
                lineColor: '#64748b',
                secondaryColor: '#10b981',
                tertiaryColor: '#f59e0b',
                background: '#ffffff',
                mainBkg: '#f8fafc',
                secondBkg: '#e2e8f0',
                border1: '#cbd5e1',
                border2: '#94a3b8'
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            },
            sequence: {
                useMaxWidth: true,
                wrap: true
            },
            gantt: {
                useMaxWidth: true
            }
        });

        // Expose mermaid globally and signal it's ready
        window.mermaid = mermaid;
        window.mermaidReady = true;

        // Dispatch event when mermaid is ready
        window.dispatchEvent(new Event('mermaidLoaded'));
    </script>
</head>
<body>
    <aside class="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="back-link">← All Modules</a>
            <h1>Store Operations</h1>
        </div>

        <nav>
            <div class="nav-section">
                <h3>Navigation</h3>
                <ul>
                    <li><a href="../index.html">Module Overview</a></li>
                    <li><a href="../index.html#features">Features</a></li>
                </ul>
            </div>
        </nav>
    </aside>

    <div class="main-content">
        <div class="breadcrumb"><a href="../index.html">Documentation</a> / <a href="../index.html">SO</a></div>

        <div class="content-wrapper">
            <div class="document-content" id="markdown-content"></div>

            <aside class="toc-sidebar">
                <div class="toc-sticky">
                    <div class="toc-title">On This Page</div>
                    <ul class="toc-list" id="toc-list"></ul>
                </div>
            </aside>
        </div>
    </div>

    <script>
        const markdownContent = "# Store Operations Module - Complete Specification\n\n## Module Overview\n\nThe Store Operations module is a comprehensive inventory and requisition management system designed for hospitality operations. It manages store-to-store requisitions, stock replenishment tracking, and wastage reporting through an integrated interface.\n\n**Primary Functions:**\n- Store requisition lifecycle management\n- Stock replenishment monitoring and alerts\n- Wastage tracking and reporting\n- Drag-and-drop dashboard customization\n- Multi-level approval workflows\n\n## Architecture Overview\n\n```\napp/(main)/store-operations/\n├── page.tsx                           # Dashboard with draggable widgets\n├── components/\n│   ├── store-requisition-list.tsx     # Main requisitions list component\n│   ├── store-replenishment.tsx        # Stock replenishment dashboard\n│   └── wastage-reporting.tsx          # Wastage analytics component\n├── store-requisitions/\n│   └── components/\n│       └── store-requisition-detail.tsx # Detailed requisition management (1950 lines)\n├── stock-replenishment/\n│   └── page.tsx                       # Stock replenishment page wrapper\n└── wastage-reporting/\n    └── page.tsx                       # Wastage reporting page wrapper\n```\n\n---\n\n## 1. Store Operations Dashboard\n\n![Store Operations Dashboard](store-operations-dashboard.png)\n\n**File:** `app/(main)/store-operations/page.tsx`\n\n### Features\n- **Draggable Widget System**: 6 customizable dashboard widgets using React Beautiful DnD\n- **Interactive Charts**: Recharts integration for data visualization\n- **Real-time Statistics**: Key performance indicators for store operations\n\n### Widgets Available\n\n#### 1. Stock Replenishment Trend\n- **Type**: Line Chart (Recharts)\n- **Data**: Monthly stock level trends\n- **Interactions**: Hover tooltips, trend analysis\n\n#### 2. Wastage by Type\n- **Type**: Bar Chart (Recharts)\n- **Categories**: Food, Beverages, Supplies, Equipment\n- **Color Coding**: Category-specific color scheme\n\n#### 3. Top 5 Stores by Requisitions\n- **Type**: Horizontal Bar Chart\n- **Metrics**: Requisition count, value totals\n- **Sorting**: Descending by requisition count\n\n#### 4. Pending Approvals Count\n- **Type**: Metric Card\n- **Data**: Real-time approval queue count\n- **Alert**: Red indicator for overdue approvals\n\n#### 5. Low Stock Alerts\n- **Type**: Alert List\n- **Threshold**: Below reorder point\n- **Actions**: Quick requisition creation\n\n#### 6. Recent Activity Feed\n- **Type**: Timeline List\n- **Events**: Requisitions, approvals, stock movements\n- **Real-time**: Auto-refresh capability\n\n### Drag and Drop Implementation\n```typescript\n// Widget dragging using React Beautiful DnD\nconst onDragEnd = (result: DropResult) => {\n  if (!result.destination) return;\n\n  const newItems = Array.from(items);\n  const [reorderedItem] = newItems.splice(result.source.index, 1);\n  newItems.splice(result.destination.index, 0, reorderedItem);\n\n  setItems(newItems);\n};\n```\n\n---\n\n## 2. Store Requisitions List\n\n![Store Requisitions List](store-requisition-list.png)\n\n**File:** `app/(main)/store-operations/components/store-requisition-list.tsx`\n\n### Primary Features\n\n#### View Toggle System\n- **Table View**: Comprehensive data grid with sorting\n- **Card View**: Visual card layout for mobile-friendly browsing\n- **Toggle Control**: Seamless switching between views\n\n#### Advanced Filter System\n- **Filter Builder**: Dynamic filter construction\n- **Pre-built Filters**: Quick access to common filter combinations\n- **Date Range Picker**: Custom date range selection\n- **Status Filters**: Multi-select status filtering\n- **Location Filters**: Store and department filtering\n\n#### Data Table Features\n- **Column Sorting**: All columns sortable (ascending/descending)\n- **Multi-select**: Checkbox selection for bulk operations\n- **Row Actions**: Context menu for individual items\n- **Pagination**: Server-side pagination with page size selection\n- **Go-to-page**: Direct page navigation input\n\n#### Search Functionality\n- **Global Search**: Searches across all visible columns\n- **Real-time**: Debounced search with instant results\n- **Highlight**: Search term highlighting in results\n\n### Data Structure\n```typescript\ninterface Requisition {\n  date: string\n  refNo: string              // Unique reference number\n  requestTo: string          // Target location/department\n  toLocation: string         // Physical location\n  storeName: string          // Requesting store name\n  description: string        // Requisition description\n  status: 'In Process' | 'Complete' | 'Reject' | 'Void' | 'Draft'\n  workflowStage?: string     // Current workflow stage\n  totalAmount: number        // Total monetary value\n  currency: string           // Currency code (USD, etc.)\n}\n```\n\n### Status Badge System\n- **In Process**: Blue badge with processing icon\n- **Complete**: Green badge with checkmark\n- **Reject**: Red badge with X icon\n- **Void**: Gray badge with void indicator\n- **Draft**: Orange badge with draft icon\n\n### Bulk Actions Available\n- **Bulk Approve**: Approve multiple requisitions\n- **Bulk Reject**: Reject multiple with reason\n- **Export Selected**: Export to CSV/Excel\n- **Print Selected**: Print requisition documents\n- **Bulk Status Update**: Change status for multiple items\n\n---\n\n## 3. Store Requisition Detail\n\n![Store Requisition Detail - Items Tab](store-requisition-detail-items.png)\n![Store Requisition Detail - Stock Movements](store-requisition-detail-stock.png)\n\n**File:** `app/(main)/store-operations/store-requisitions/components/store-requisition-detail.tsx`\n**Size:** 1,950 lines - Most complex component in the module\n\n### Tab Navigation System\n\n#### Tab 1: Items Management\n**Primary Focus:** Individual item management within requisitions\n\n##### Item Data Table\n- **Columns**: Description, Unit, Required Qty, Approved Qty, Issued Qty, Cost, Total, Tax, Discount\n- **Inline Editing**: Direct cell editing for quantity adjustments\n- **Approval Controls**: Individual item approval/rejection\n- **Status Tracking**: Per-item approval status (Pending, Approved, Reject, Review)\n\n##### Item Detail Modal\n**Triggered by:** Edit button on any item row\n\n**Fields Available:**\n- Product Information (Name, SKU, Description)\n- Quantity Management (Required, Approved, Issued)\n- Pricing (Unit Cost, Tax Rate, Discount Rate)\n- Approval Status and Comments\n- Inventory Details (Current Stock, Location)\n\n##### Bulk Item Operations\n- **Bulk Approve**: Approve all selected items\n- **Bulk Reject**: Reject with bulk reason\n- **Quantity Adjustments**: Bulk quantity changes\n- **Price Updates**: Bulk pricing modifications\n\n#### Tab 2: Stock Movements\n**Primary Focus:** Inventory transaction tracking\n\n##### Movement Records Table\n- **Columns**: Date, Type, Item, Quantity, From Location, To Location, Lot Number, Expiry\n- **Movement Types**: Issue, Receipt, Transfer, Adjustment, Return\n- **Lot Tracking**: Full lot number traceability\n- **Expiry Management**: Date tracking for perishables\n\n##### Movement History\n- **Chronological**: Time-ordered movement log\n- **Filtering**: By date range, movement type, item\n- **Export**: Movement history export capability\n\n#### Tab 3: Journal Entries\n**Primary Focus:** Financial transaction recording\n\n##### Journal Entry List\n- **Columns**: Date, Account, Description, Debit, Credit, Reference\n- **Auto-generation**: Automatic entry creation from approvals\n- **Manual Entries**: Ability to add manual journal entries\n- **Validation**: Account balance validation\n\n#### Tab 4: Approval Workflow\n**Primary Focus:** Multi-stage approval management\n\n##### Workflow Status Display\n- **Stage Indicators**: Visual workflow progress\n- **Approver Queue**: Current and pending approvers\n- **History**: Complete approval history log\n- **Escalation**: Automatic escalation for overdue approvals\n\n##### Approval Actions\n- **Approve**: Full requisition approval\n- **Reject**: Rejection with mandatory reason\n- **Request Changes**: Send back for modifications\n- **Delegate**: Delegate approval to another user\n- **Add Comments**: Approval comments and notes\n\n### Activity Sidebar\n\n#### Comments Section\n- **Threaded Comments**: Reply capability\n- **User Attribution**: Commenter identification and timestamp\n- **Rich Text**: Basic formatting support\n- **Notifications**: Comment notification system\n\n#### Attachments Section\n- **File Upload**: Drag-and-drop file upload\n- **File Types**: Documents, images, spreadsheets\n- **File Preview**: In-browser file preview\n- **Version Control**: File version management\n\n#### Activity Log\n- **Event Tracking**: All requisition activities logged\n- **User Actions**: Who, what, when for all changes\n- **System Events**: Automatic system-generated events\n- **Export**: Activity log export capability\n\n#### Toggle Controls\n- **Show/Hide Sidebar**: Collapsible sidebar for screen space\n- **Section Toggles**: Individual section show/hide\n- **Persistent Settings**: User preference storage\n\n### Complex Data Structures\n```typescript\ninterface RequisitionItem {\n  id: number\n  description: string\n  unit: string\n  qtyRequired: number\n  qtyApproved: number\n  qtyIssued: number\n  costPerUnit: number\n  total: number\n  taxRate: number\n  discountRate: number\n  approvalStatus: 'Pending' | 'Approved' | 'Reject' | 'Review'\n  inventory: InventoryInfo\n  itemInfo: ItemInfo\n  comments?: string[]\n  attachments?: AttachmentInfo[]\n}\n\ninterface StockMovement {\n  id: number\n  date: string\n  type: 'Issue' | 'Receipt' | 'Transfer' | 'Adjustment' | 'Return'\n  itemId: number\n  quantity: number\n  fromLocation: string\n  toLocation: string\n  lotNumber?: string\n  expiryDate?: string\n  reference: string\n  userId: number\n}\n\ninterface JournalEntry {\n  id: number\n  date: string\n  account: string\n  description: string\n  debitAmount: number\n  creditAmount: number\n  reference: string\n  requisitionId: number\n  userId: number\n}\n```\n\n---\n\n## 4. Stock Replenishment\n\n![Stock Replenishment](store-replenishment-page.png)\n\n**File:** `app/(main)/store-operations/components/stock-replenishment.tsx`\n\n### Dashboard Components\n\n#### Statistics Cards\n1. **Total SKUs**: Overall product count (1,234)\n2. **Low Stock Items**: Items below reorder point (28 - Red alert)\n3. **Items on Order**: Currently ordered items (45 - Orange indicator)\n4. **Stock Value**: Total inventory value ($45,678 - Green trending up)\n\n#### Stock Level Trend Chart\n- **Type**: Responsive Line Chart (Recharts)\n- **Data Period**: 6-month rolling trend\n- **Interactions**: Hover tooltips, zoom capability\n- **Y-axis**: Stock level quantities\n- **X-axis**: Monthly periods (Jan-Jun)\n\n#### Low Stock Alert Banner\n- **Alert Type**: Warning banner with red styling\n- **Message**: \"8 items are below minimum stock levels and require immediate attention\"\n- **Icon**: Alert Triangle (Lucide React)\n- **Action**: Click to filter low stock items\n\n### Inventory Status Table\n\n#### Table Structure\n| Column | Type | Description | Actions |\n|--------|------|-------------|---------|\n| Select | Checkbox | Multi-select for bulk operations | Select all/individual |\n| Location | Text + Code | Store location with code | Sortable |\n| Product | Text + SKU | Product name, SKU, description | Searchable |\n| Current Stock | Number | Current quantity on hand | Color-coded alerts |\n| PAR Level | Number | Periodic Automatic Replenishment level | Editable |\n| Reorder Point | Number | Minimum stock trigger point | Editable |\n| On Order | Number | Quantity currently on order | Read-only |\n| Order Amount | Number Input | Suggested/manual order quantity | Editable |\n| Order Unit | Dropdown | Unit of measure selection | Selectable |\n| Status | Badge | Stock status indicator | Visual |\n\n#### Advanced Features\n\n##### Smart Reorder Calculations\n```typescript\nconst suggestedOrder = Math.max(0, item.parLevel - (item.currentStock + item.onOrder));\n```\n\n##### Status Color Coding\n- **LOW**: Red background, white text - Below reorder point\n- **NORMAL**: Green background, white text - Above reorder point\n- **HIGH**: Blue background, white text - Above PAR level\n\n##### Unit Selection Options\n- Box, Bag, Pack, Piece, Kg (Dropdown selection)\n- Dynamic unit conversion capability\n- Vendor-specific unit preferences\n\n#### Search and Filter System\n- **Global Search**: Product name, SKU, location search\n- **Advanced Filters**: Status, location, stock level ranges\n- **Quick Filters**: Low stock, on order, specific locations\n\n#### Bulk Operations\n- **Create Requisition**: Generate requisition from selected items\n- **Bulk Order Amount**: Set order amounts for multiple items\n- **Export**: Export selection to CSV/Excel\n- **Print**: Print stock status report\n\n---\n\n## 5. Wastage Reporting\n\n![Wastage Reporting](wastage-reporting-page.png)\n\n**File:** `app/(main)/store-operations/wastage-reporting/page.tsx`\n\n### Statistics Dashboard\n\n#### Key Metrics Cards\n1. **Total Wastage**: Monthly wastage value ($2,450)\n2. **Items Written Off**: Count of written-off items (23 items)\n3. **Pending Reviews**: Items awaiting review (5 pending)\n\n#### Monthly Wastage Trend\n- **Chart Type**: Area Chart (Recharts)\n- **Time Period**: 12-month rolling view\n- **Data Points**: Monthly wastage values\n- **Trend Analysis**: Month-over-month comparison\n\n### Wastage Records Management\n\n#### Records Table Structure\n| Column | Data Type | Description | Actions |\n|--------|-----------|-------------|---------|\n| Date | Date | Wastage occurrence date | Sortable |\n| Location | Text | Store/department location | Filterable |\n| Item | Text + SKU | Product details | Searchable |\n| Quantity | Number | Waste quantity | Numeric input |\n| Unit | Text | Unit of measure | Dropdown |\n| Reason | Text | Wastage reason/category | Categorized |\n| Cost | Currency | Financial impact | Calculated |\n| Status | Badge | Review status | Workflow |\n| Actions | Buttons | Record management | CRUD operations |\n\n#### Wastage Categories\n- **Expiry**: Items past expiration date\n- **Damage**: Physical damage during handling/storage\n- **Spoilage**: Natural spoilage/deterioration\n- **Contamination**: Cross-contamination incidents\n- **Over-preparation**: Excess food preparation\n- **Quality Issues**: Below quality standards\n- **Other**: Miscellaneous reasons\n\n#### Advanced Analytics\n- **Cost Analysis**: Wastage cost breakdown by category\n- **Trend Analysis**: Seasonal and monthly patterns\n- **Location Comparison**: Store-by-store wastage comparison\n- **Item Analysis**: Most wasted items identification\n- **Root Cause**: Recurring wastage pattern analysis\n\n---\n\n## Shared Components and Utilities\n\n### 1. Advanced Filter Builder\n```typescript\ninterface FilterRule {\n  field: string\n  operator: 'equals' | 'contains' | 'greater_than' | 'less_than' | 'between'\n  value: string | number | Date\n  condition: 'and' | 'or'\n}\n```\n\n**Features:**\n- Dynamic filter rule construction\n- Multiple condition support (AND/OR logic)\n- Field-specific operators\n- Saved filter profiles\n- Quick filter templates\n\n### 2. Status Badge Component\n```typescript\ninterface StatusBadgeProps {\n  status: string\n  variant: 'success' | 'warning' | 'error' | 'info' | 'neutral'\n  icon?: boolean\n  size?: 'sm' | 'md' | 'lg'\n}\n```\n\n**Variants:**\n- **Success**: Green background, checkmark icon\n- **Warning**: Orange background, warning icon\n- **Error**: Red background, X icon\n- **Info**: Blue background, info icon\n- **Neutral**: Gray background, no icon\n\n### 3. Pagination Component\n```typescript\ninterface PaginationProps {\n  currentPage: number\n  totalPages: number\n  pageSize: number\n  totalItems: number\n  onPageChange: (page: number) => void\n  onPageSizeChange: (size: number) => void\n}\n```\n\n**Features:**\n- First/Previous/Next/Last navigation\n- Direct page input (go-to-page)\n- Page size selection (10, 25, 50, 100)\n- Total count display\n- Responsive design\n\n### 4. Modal Dialog System\n**Types Available:**\n- **Edit Item Modal**: Full item editing interface\n- **Confirmation Dialog**: Action confirmation with details\n- **Advanced Filter Modal**: Complex filter construction\n- **Upload Modal**: File upload interface\n- **Comment Modal**: Comment creation/editing\n\n**Common Features:**\n- Backdrop click to close (configurable)\n- Escape key handling\n- Focus management\n- Size variants (sm, md, lg, xl, full)\n- Scrollable content areas\n\n---\n\n## Data Flow and State Management\n\n### 1. Requisition Lifecycle\n```mermaid\nstateDiagram-v2\n    [*] --> Draft\n    Draft --> Submitted\n    Submitted --> In_Process\n    In_Process --> Approved\n    In_Process --> Rejected\n    In_Process --> Requires_Changes\n    Requires_Changes --> Submitted\n    Approved --> Fulfilled\n    Approved --> Partially_Fulfilled\n    Partially_Fulfilled --> Fulfilled\n    Rejected --> [*]\n    Fulfilled --> [*]\n```\n\n### 2. Stock Replenishment Flow\n```mermaid\nflowchart TD\n    A[Monitor Stock Levels] --> B{Below Reorder Point?}\n    B -->|Yes| C[Generate Alert]\n    B -->|No| A\n    C --> D[Review Suggested Orders]\n    D --> E[Adjust Order Quantities]\n    E --> F[Create Requisition]\n    F --> G[Submit for Approval]\n    G --> H[Approval Workflow]\n    H --> I[Generate Purchase Order]\n    I --> J[Track Delivery]\n    J --> K[Update Stock Levels]\n    K --> A\n```\n\n### 3. Wastage Reporting Workflow\n```mermaid\nflowchart TD\n    A[Identify Waste] --> B[Record Waste Entry]\n    B --> C[Classify Reason]\n    C --> D[Calculate Cost Impact]\n    D --> E[Submit for Review]\n    E --> F{Approve Waste?}\n    F -->|Yes| G[Write Off Inventory]\n    F -->|No| H[Return for Investigation]\n    H --> C\n    G --> I[Update Financial Records]\n    I --> J[Generate Reports]\n```\n\n---\n\n## API Integration Points\n\n### 1. Data Fetching Patterns\n```typescript\n// Requisition data fetching with filtering\nconst fetchRequisitions = async (filters: FilterOptions) => {\n  const params = new URLSearchParams({\n    page: filters.page.toString(),\n    pageSize: filters.pageSize.toString(),\n    status: filters.status,\n    dateRange: JSON.stringify(filters.dateRange),\n    searchTerm: filters.searchTerm\n  });\n\n  const response = await fetch(`/api/requisitions?${params}`);\n  return response.json();\n};\n\n// Real-time stock level monitoring\nconst useStockLevels = () => {\n  const [stockData, setStockData] = useState([]);\n\n  useEffect(() => {\n    const interval = setInterval(async () => {\n      const data = await fetch('/api/stock-levels').then(r => r.json());\n      setStockData(data);\n    }, 30000); // Update every 30 seconds\n\n    return () => clearInterval(interval);\n  }, []);\n\n  return stockData;\n};\n```\n\n### 2. State Management Patterns\n```typescript\n// Zustand store for requisition management\ninterface RequisitionStore {\n  requisitions: Requisition[]\n  filters: FilterOptions\n  selectedItems: string[]\n  loading: boolean\n\n  setRequisitions: (requisitions: Requisition[]) => void\n  updateFilters: (filters: Partial<FilterOptions>) => void\n  toggleItemSelection: (id: string) => void\n  clearSelection: () => void\n}\n\n// React Query for server state\nconst useRequisitionDetail = (id: string) => {\n  return useQuery({\n    queryKey: ['requisition', id],\n    queryFn: () => fetchRequisitionDetail(id),\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    refetchOnWindowFocus: false,\n  });\n};\n```\n\n---\n\n## Performance Considerations\n\n### 1. Code Splitting\n```typescript\n// Lazy loading for heavy components\nconst StoreRequisitionDetail = lazy(() =>\n  import('./components/store-requisition-detail')\n);\n\n// Route-based code splitting\nconst StockReplenishment = lazy(() =>\n  import('./stock-replenishment/page')\n);\n```\n\n### 2. Data Virtualization\n- **Large Tables**: Virtual scrolling for 1000+ rows\n- **Infinite Scroll**: Progressive data loading\n- **Pagination**: Server-side pagination for performance\n- **Caching**: Intelligent data caching strategies\n\n### 3. Optimization Strategies\n- **Memoization**: React.memo for expensive components\n- **Debouncing**: Search input debouncing (300ms)\n- **Bundle Splitting**: Route-based code splitting\n- **Image Optimization**: Next.js Image component usage\n\n---\n\n## Accessibility Features\n\n### 1. Keyboard Navigation\n- **Tab Order**: Logical tab sequence through all interactive elements\n- **Skip Links**: Skip to main content functionality\n- **Focus Management**: Visible focus indicators\n- **Shortcuts**: Keyboard shortcuts for common actions\n\n### 2. Screen Reader Support\n- **ARIA Labels**: Comprehensive ARIA labeling\n- **Role Attributes**: Proper semantic roles\n- **Live Regions**: Dynamic content announcements\n- **Alt Text**: Descriptive alternative text for images\n\n### 3. Visual Accessibility\n- **Color Contrast**: WCAG AA compliant contrast ratios\n- **Font Sizes**: Scalable text with rem units\n- **Motion Preferences**: Respects reduced motion preferences\n- **High Contrast**: High contrast mode support\n\n---\n\n## Testing Strategy\n\n### 1. Unit Testing\n```typescript\n// Component testing with Jest and React Testing Library\ndescribe('StoreRequisitionList', () => {\n  it('should filter requisitions by status', async () => {\n    render(<StoreRequisitionList />);\n\n    const statusFilter = screen.getByRole('combobox', { name: /status/i });\n    fireEvent.change(statusFilter, { target: { value: 'approved' } });\n\n    await waitFor(() => {\n      expect(screen.getByText('Approved')).toBeInTheDocument();\n    });\n  });\n});\n```\n\n### 2. Integration Testing\n- **API Integration**: Mock API responses for consistent testing\n- **User Workflows**: End-to-end user journey testing\n- **Data Flow**: State management integration testing\n\n### 3. Performance Testing\n- **Load Testing**: Large dataset rendering performance\n- **Memory Testing**: Memory leak detection\n- **Bundle Analysis**: Bundle size optimization testing\n\n---\n\n## Security Considerations\n\n### 1. Data Protection\n- **Input Sanitization**: XSS prevention through proper sanitization\n- **CSRF Protection**: Cross-site request forgery protection\n- **Authentication**: Role-based access control\n- **Authorization**: Permission-based feature access\n\n### 2. Data Validation\n```typescript\n// Zod schema validation\nconst requisitionSchema = z.object({\n  description: z.string().min(1).max(500),\n  totalAmount: z.number().positive(),\n  status: z.enum(['draft', 'submitted', 'approved', 'rejected']),\n  items: z.array(requisitionItemSchema).min(1),\n});\n```\n\n---\n\nThis specification provides comprehensive documentation of the Store Operations module, covering all UI elements, workflows, actions, and technical implementation details. The module represents a sophisticated inventory management system with complex approval workflows, real-time monitoring, and comprehensive reporting capabilities.";

        // Configure marked
        marked.setOptions({
            highlight: function(code, lang) {
                return code;
            },
            breaks: true,
            gfm: true
        });

        // Render markdown
        const contentDiv = document.getElementById('markdown-content');
        contentDiv.innerHTML = marked.parse(markdownContent);

        // Function to render Mermaid diagrams
        function renderMermaidDiagrams() {
            if (!window.mermaid) {
                console.log('Mermaid not loaded yet, waiting...');
                return;
            }

            // Find all code blocks with mermaid language
            const mermaidBlocks = contentDiv.querySelectorAll('pre code.language-mermaid, pre code[class*="mermaid"]');

            if (mermaidBlocks.length === 0) {
                console.log('No mermaid blocks found');
                return;
            }

            console.log('Found', mermaidBlocks.length, 'mermaid blocks');

            mermaidBlocks.forEach((block, index) => {
                const mermaidCode = block.textContent;
                const pre = block.parentElement;

                // Create a div for mermaid diagram
                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = mermaidCode;
                mermaidDiv.id = 'mermaid-diagram-' + index;

                // Replace the pre block with mermaid div
                pre.replaceWith(mermaidDiv);
            });

            // Run mermaid rendering
            window.mermaid.run({
                querySelector: '.mermaid'
            }).then(() => {
                console.log('Mermaid diagrams rendered successfully');
            }).catch(err => {
                console.error('Mermaid rendering error:', err);
            });
        }

        // Wait for mermaid to load before rendering
        if (window.mermaidReady) {
            renderMermaidDiagrams();
        } else {
            window.addEventListener('mermaidLoaded', renderMermaidDiagrams);
            // Fallback timeout
            setTimeout(renderMermaidDiagrams, 1000);
        }

        // Generate TOC from headings
        const tocList = document.getElementById('toc-list');
        const headings = contentDiv.querySelectorAll('h2, h3, h4');

        headings.forEach((heading, index) => {
            const id = 'heading-' + index;
            heading.id = id;

            const li = document.createElement('li');
            const a = document.createElement('a');
            a.href = '#' + id;
            a.textContent = heading.textContent;
            a.className = 'toc-' + heading.tagName.toLowerCase();

            li.appendChild(a);
            tocList.appendChild(li);
        });

        // Highlight active TOC item on scroll
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const id = entry.target.id;
                    tocList.querySelectorAll('a').forEach(a => {
                        a.style.color = a.getAttribute('href') === '#' + id ? 'var(--primary)' : 'var(--text-secondary)';
                        a.style.fontWeight = a.getAttribute('href') === '#' + id ? '600' : '400';
                    });
                }
            });
        }, { threshold: 1.0 });

        headings.forEach(heading => observer.observe(heading));
    </script>
</body>
</html>