<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Operational Planning Module - Carmen ERP Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --secondary: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg-light: #f8fafc;
            --bg-white: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: var(--bg-light);
            color: var(--text-primary);
            line-height: 1.6;
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background: var(--bg-white);
            border-right: 1px solid var(--border);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            padding: 2rem 0;
        }

        .sidebar-header {
            padding: 0 1.5rem;
            margin-bottom: 2rem;
        }

        .sidebar-header h1 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .back-link:hover {
            color: var(--primary);
        }

        .sidebar nav {
            padding: 0 1rem;
        }

        .nav-section {
            margin-bottom: 1.5rem;
        }

        .nav-section h3 {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            padding: 0 0.5rem;
            margin-bottom: 0.5rem;
        }

        .nav-section ul {
            list-style: none;
        }

        .nav-section a {
            display: block;
            padding: 0.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .nav-section a:hover,
        .nav-section a.active {
            background: var(--bg-light);
            color: var(--primary);
        }

        .main-content {
            margin-left: 280px;
            flex: 1;
            padding: 2rem;
            max-width: calc(100% - 280px);
        }

        .breadcrumb {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .breadcrumb a {
            color: var(--primary);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .content-wrapper {
            display: flex;
            gap: 2rem;
        }

        .document-content {
            flex: 1;
            background: var(--bg-white);
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
            min-width: 0;
        }

        .toc-sidebar {
            width: 250px;
            flex-shrink: 0;
        }

        .toc-sticky {
            position: sticky;
            top: 2rem;
            background: var(--bg-white);
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
        }

        .toc-title {
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .toc-list {
            list-style: none;
        }

        .toc-list a {
            display: block;
            padding: 0.25rem 0;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            transition: color 0.2s;
        }

        .toc-list a:hover {
            color: var(--primary);
        }

        .toc-list .toc-h2 {
            margin-left: 0;
            font-weight: 500;
        }

        .toc-list .toc-h3 {
            margin-left: 1rem;
            font-size: 0.8125rem;
        }

        .toc-list .toc-h4 {
            margin-left: 2rem;
            font-size: 0.75rem;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        h2 {
            font-size: 1.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border);
            color: var(--text-primary);
        }

        h3 {
            font-size: 1.25rem;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        h4 {
            font-size: 1.125rem;
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        p {
            margin-bottom: 1rem;
        }

        ul, ol {
            margin-bottom: 1rem;
            padding-left: 2rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        code {
            background: var(--bg-light);
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.875rem;
        }

        pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin-bottom: 1rem;
        }

        pre code {
            background: transparent;
            padding: 0;
            color: inherit;
        }

        blockquote {
            border-left: 4px solid var(--primary);
            padding-left: 1rem;
            margin: 1rem 0;
            color: var(--text-secondary);
            font-style: italic;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
        }

        th, td {
            border: 1px solid var(--border);
            padding: 0.75rem;
            text-align: left;
        }

        th {
            background: var(--bg-light);
            font-weight: 600;
        }

        a {
            color: var(--primary);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        hr {
            border: none;
            border-top: 1px solid var(--border);
            margin: 2rem 0;
        }

        img {
            max-width: 600px;
            height: auto;
            border-radius: 0.5rem;
            border: 1px solid var(--border);
            margin: 1rem 0;
            display: block;
        }

        .mermaid {
            background: var(--bg-white);
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1.5rem 0;
            display: flex;
            justify-content: center;
            border: 1px solid var(--border);
            max-width: 800px;
            overflow-x: auto;
        }

        .mermaid svg {
            max-width: 100%;
            max-height: 500px;
            height: auto;
            transform: scale(0.85);
            transform-origin: top center;
        }

        @media (max-width: 1024px) {
            .sidebar {
                display: none;
            }

            .main-content {
                margin-left: 0;
                max-width: 100%;
            }

            .toc-sidebar {
                display: none;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';

        // Initialize Mermaid with enhanced configuration
        mermaid.initialize({
            startOnLoad: false,
            theme: 'default',
            themeVariables: {
                primaryColor: '#2563eb',
                primaryTextColor: '#0f172a',
                primaryBorderColor: '#1e40af',
                lineColor: '#64748b',
                secondaryColor: '#10b981',
                tertiaryColor: '#f59e0b',
                background: '#ffffff',
                mainBkg: '#f8fafc',
                secondBkg: '#e2e8f0',
                border1: '#cbd5e1',
                border2: '#94a3b8'
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            },
            sequence: {
                useMaxWidth: true,
                wrap: true
            },
            gantt: {
                useMaxWidth: true
            }
        });

        // Expose mermaid globally and signal it's ready
        window.mermaid = mermaid;
        window.mermaidReady = true;

        // Dispatch event when mermaid is ready
        window.dispatchEvent(new Event('mermaidLoaded'));
    </script>
</head>
<body>
    <aside class="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="back-link">‚Üê All Modules</a>
            <h1>Operational Planning</h1>
        </div>

        <nav>
            <div class="nav-section">
                <h3>Navigation</h3>
                <ul>
                    <li><a href="../index.html">Module Overview</a></li>
                    <li><a href="../index.html#features">Features</a></li>
                </ul>
            </div>
        </nav>
    </aside>

    <div class="main-content">
        <div class="breadcrumb"><a href="../index.html">Documentation</a> / <a href="../index.html">OP</a></div>

        <div class="content-wrapper">
            <div class="document-content" id="markdown-content"></div>

            <aside class="toc-sidebar">
                <div class="toc-sticky">
                    <div class="toc-title">On This Page</div>
                    <ul class="toc-list" id="toc-list"></ul>
                </div>
            </aside>
        </div>
    </div>

    <script>
        const markdownContent = "# Operational Planning Module\n\n> **Module:** Operational Planning\n> **Total Pages:** 25\n> **Status:** ‚úÖ Production Ready\n\n---\n\n## Overview\n\nThe Operational Planning module provides comprehensive tools for hospitality operations management, including recipe management, menu engineering analysis, demand forecasting, and inventory planning. This module enables data-driven decision-making for menu optimization, cost control, and operational efficiency.\n\n### Key Features\n\n1. **Recipe Management** - Complete recipe catalog with ingredients, costing, and variations\n2. **Menu Engineering** - Performance analysis using popularity vs profitability matrix\n3. **Demand Forecasting** - Predictive analytics for sales planning\n4. **Inventory Planning** - Optimal stock level recommendations\n\n---\n\n## üì∏ System Screenshots\n\n### Recipe Management\n\n#### Recipe Library\n![Recipe Library](./screenshots/recipe-library.png)\n*The Recipe Library displays 5 comprehensive recipe cards with detailed analytics: Thai Green Curry ($4.75 cost, $16.99 selling price, 72.0% margin, 1.2 kg CO‚ÇÇeq), Beef Bourguignon ($8.50 cost, $28.99 selling, 70.7% margin, 2.8 kg CO‚ÇÇeq), Tiramisu ($2.25 cost, $8.99 selling, 74.9% margin, 0.8 kg CO‚ÇÇeq), Margherita Pizza ($14.80 cost, $34.99 selling, 57.7% margin, 2.1 kg CO‚ÇÇeq), and Chocolate Pound Cake ($20.00 cost, $89.99 selling, 77.8% margin, 1.8 kg CO‚ÇÇeq). Each recipe card shows cuisine type, course category, and CO‚ÇÇ environmental impact tracking. The interface includes search functionality, filters (No Media, Has Media, Active, Draft), Advanced Filters, Import/Export capabilities, and a New Recipe button.*\n\n#### Recipe Categories\n![Recipe Categories](./screenshots/recipe-categories.png)\n*The Recipe Categories interface shows a hierarchical table structure with 3 main categories: Appetizers (APP, 45 recipes, 38 active, $4.50 avg cost, 68.5% avg margin), Main Courses (MAIN, 80 recipes, 65 active, $12.50 avg cost, 63.5% avg margin - expandable for subcategories), and Desserts (DES, 35 recipes, 30 active, $3.75 avg cost, 72.5% avg margin). The tree structure features expand/collapse controls, Edit/Delete/Add actions per node, search functionality, filters (No Recipes, Has Recipes, Top Level, Sub Level), and Import/Export/Print buttons for comprehensive recipe organization management.*\n\n#### Cuisine Types\n![Cuisine Types](./screenshots/cuisine-types.png)\n*The Cuisine Types management interface displays 8 global cuisine classifications with regional groupings: Italian (ITA, Europe, 45 recipes, 38 active), Chinese (CHN, Asia, 60 recipes, 52 active), Mexican (MEX, Americas, 35 recipes, 30 active), Indian (IND, Asia, 50 recipes, 45 active), French (FRA, Europe, 40 recipes, 35 active), Japanese (JPN, Asia, 55 recipes, 48 active), Mediterranean (MED, Europe, 30 recipes, 25 active), and Thai (THA, Asia, 45 recipes, 40 active). The interface provides search functionality, filters (No Recipes, Has Recipes, Asian, European), More Filters option, and Import/Export/Print capabilities for cuisine type management.*\n\n### Menu Engineering\n\n#### Menu Engineering Dashboard\n![Menu Engineering Dashboard](./screenshots/menu-engineering-dashboard.png)\n*The Menu Engineering Dashboard showcases comprehensive menu optimization using the Boston Consulting Group (BCG) matrix. Key performance indicators include Total Items (4), Total Revenue ($26,000, +8.2%), Avg Contribution ($20.38), Active Alerts (3, including 1 critical), and Portfolio Health (75%). The BCG matrix scatter plot categorizes menu items into four strategic quadrants: Stars (High popularity, High profitability - Promote strategy), Plow Horses (High popularity, Low profitability - Increase prices or reduce costs), Puzzles (Low popularity, High profitability - Increase marketing), and Dogs (Low popularity, Low profitability - Consider removing). Date range filtering (Jan 01, 2024 - Oct 17, 2025), category and location filters, and tabs for Performance Matrix, Portfolio Analysis, Recipe Details, Cost Alerts, and Data Import enable comprehensive menu performance management.*\n\n### Planned Features (Coming Soon)\n\nThe following screenshots document features that are planned but not yet implemented:\n\n#### Demand Forecasting\n![Demand Forecasting](./screenshots/demand-forecasting.png)\n*Planned feature: Predictive analytics for sales planning and demand forecasting based on historical data, seasonality patterns, and market trends. Coming in future release.*\n\n#### Inventory Planning\n![Inventory Planning](./screenshots/inventory-planning.png)\n*Planned feature: Optimal stock level recommendations and automated inventory planning based on recipe requirements and demand forecasts. Coming in future release.*\n\n---\n\n## Module Structure\n\n### Features Documentation\n\n- [Recipe Management](./features/recipe-management/README.md) - Recipe catalog, categories, cuisine types\n- [Menu Engineering](./features/menu-engineering/README.md) - Menu performance matrix and optimization\n- [Dashboard & Analytics](./features/dashboard/README.md) - Demand forecasting and inventory planning\n\n---\n\n## Quick Start\n\n### Accessing the Module\n\nNavigate to: `/operational-planning`\n\n### Main Features\n\n**Recipe Management**\n- Browse and search recipes\n- Create and edit recipes\n- Manage categories and cuisine types\n- Track recipe costs and margins\n\n**Menu Engineering**\n- Performance matrix (Stars, Plow Horses, Puzzles, Dogs)\n- Sales data import and analysis\n- Cost alert management\n- Recipe performance metrics\n\n**Dashboard**\n- Demand forecast vs actual\n- Menu performance trends\n- Inventory planning status\n- Drag-and-drop customization\n\n---\n\n## Key Metrics\n\n**Menu Engineering**:\n- Total menu items\n- Total revenue and contribution\n- Active cost alerts\n- Portfolio health score\n\n**Recipe Management**:\n- Total active recipes\n- Average recipe cost\n- Cost variance tracking\n- Recipe utilization\n\n---\n\n## User Roles & Permissions\n\n| Feature | Chef | Kitchen Manager | GM | Staff |\n|---------|------|----------------|----|----|-----|\n| View Recipes | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |\n| Edit Recipes | ‚úÖ | ‚úÖ | ‚ö†Ô∏è | ‚ùå |\n| Menu Engineering | ‚ö†Ô∏è | ‚úÖ | ‚úÖ | ‚ùå |\n| Cost Analysis | ‚ùå | ‚úÖ | ‚úÖ | ‚ùå |\n| Forecasting | ‚ùå | ‚ö†Ô∏è | ‚úÖ | ‚ùå |\n\nLegend: ‚úÖ Full Access | ‚ö†Ô∏è Read Only | ‚ùå No Access\n\n---\n\n## Integration Points\n\n### System Integrations\n- **Inventory Management** - Recipe ingredient tracking and stock deductions\n- **POS Systems** - Sales data import for menu engineering\n- **Product Management** - Product catalog integration\n- **Finance** - Cost tracking and profitability analysis\n- **Vendor Management** - Supplier pricing and product sourcing\n\n### Data Flow\n```\nPOS Sales Data ‚Üí Menu Engineering ‚Üí Performance Analysis\nRecipe Ingredients ‚Üí Inventory ‚Üí Stock Planning\nDemand Forecast ‚Üí Inventory Planning ‚Üí Purchase Orders\nMenu Performance ‚Üí Recipe Optimization ‚Üí Cost Reduction\n```\n\n---\n\n## Technical Architecture\n\n### Tech Stack\n- **Framework**: Next.js 14 with App Router\n- **UI Components**: Shadcn/ui, Recharts for visualization\n- **State Management**: Zustand for recipes, React Query for server state\n- **Drag & Drop**: react-beautiful-dnd for dashboard customization\n\n### Data Models\nSee individual feature documentation for detailed TypeScript interfaces and data models.\n\n---\n\n## Related Documentation\n\n- [System Administration](../sa/README.md)\n- [Inventory Management](../inventory/README.md)\n- [Procurement](../procurement/README.md)\n- [Product Management](../product/README.md)\n\n---\n\n**Last Updated:** 2025-01-17\n**Version:** 1.0.0\n";

        // Configure marked
        marked.setOptions({
            highlight: function(code, lang) {
                return code;
            },
            breaks: true,
            gfm: true
        });

        // Render markdown
        const contentDiv = document.getElementById('markdown-content');
        contentDiv.innerHTML = marked.parse(markdownContent);

        // Function to render Mermaid diagrams
        function renderMermaidDiagrams() {
            if (!window.mermaid) {
                console.log('Mermaid not loaded yet, waiting...');
                return;
            }

            // Find all code blocks with mermaid language
            const mermaidBlocks = contentDiv.querySelectorAll('pre code.language-mermaid, pre code[class*="mermaid"]');

            if (mermaidBlocks.length === 0) {
                console.log('No mermaid blocks found');
                return;
            }

            console.log('Found', mermaidBlocks.length, 'mermaid blocks');

            mermaidBlocks.forEach((block, index) => {
                const mermaidCode = block.textContent;
                const pre = block.parentElement;

                // Create a div for mermaid diagram
                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = mermaidCode;
                mermaidDiv.id = 'mermaid-diagram-' + index;

                // Replace the pre block with mermaid div
                pre.replaceWith(mermaidDiv);
            });

            // Run mermaid rendering
            window.mermaid.run({
                querySelector: '.mermaid'
            }).then(() => {
                console.log('Mermaid diagrams rendered successfully');
            }).catch(err => {
                console.error('Mermaid rendering error:', err);
            });
        }

        // Wait for mermaid to load before rendering
        if (window.mermaidReady) {
            renderMermaidDiagrams();
        } else {
            window.addEventListener('mermaidLoaded', renderMermaidDiagrams);
            // Fallback timeout
            setTimeout(renderMermaidDiagrams, 1000);
        }

        // Generate TOC from headings
        const tocList = document.getElementById('toc-list');
        const headings = contentDiv.querySelectorAll('h2, h3, h4');

        headings.forEach((heading, index) => {
            const id = 'heading-' + index;
            heading.id = id;

            const li = document.createElement('li');
            const a = document.createElement('a');
            a.href = '#' + id;
            a.textContent = heading.textContent;
            a.className = 'toc-' + heading.tagName.toLowerCase();

            li.appendChild(a);
            tocList.appendChild(li);
        });

        // Highlight active TOC item on scroll
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const id = entry.target.id;
                    tocList.querySelectorAll('a').forEach(a => {
                        a.style.color = a.getAttribute('href') === '#' + id ? 'var(--primary)' : 'var(--text-secondary)';
                        a.style.fontWeight = a.getAttribute('href') === '#' + id ? '600' : '400';
                    });
                }
            });
        }, { threshold: 1.0 });

        headings.forEach(heading => observer.observe(heading));
    </script>
</body>
</html>