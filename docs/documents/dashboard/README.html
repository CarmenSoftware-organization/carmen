<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Module Documentation - Carmen ERP Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --secondary: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg-light: #f8fafc;
            --bg-white: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: var(--bg-light);
            color: var(--text-primary);
            line-height: 1.6;
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background: var(--bg-white);
            border-right: 1px solid var(--border);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            padding: 2rem 0;
        }

        .sidebar-header {
            padding: 0 1.5rem;
            margin-bottom: 2rem;
        }

        .sidebar-header h1 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .back-link:hover {
            color: var(--primary);
        }

        .sidebar nav {
            padding: 0 1rem;
        }

        .nav-section {
            margin-bottom: 1.5rem;
        }

        .nav-section h3 {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            padding: 0 0.5rem;
            margin-bottom: 0.5rem;
        }

        .nav-section ul {
            list-style: none;
        }

        .nav-section a {
            display: block;
            padding: 0.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .nav-section a:hover,
        .nav-section a.active {
            background: var(--bg-light);
            color: var(--primary);
        }

        .main-content {
            margin-left: 280px;
            flex: 1;
            padding: 2rem;
            max-width: calc(100% - 280px);
        }

        .breadcrumb {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .breadcrumb a {
            color: var(--primary);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .content-wrapper {
            display: flex;
            gap: 2rem;
        }

        .document-content {
            flex: 1;
            background: var(--bg-white);
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
            min-width: 0;
        }

        .toc-sidebar {
            width: 250px;
            flex-shrink: 0;
        }

        .toc-sticky {
            position: sticky;
            top: 2rem;
            background: var(--bg-white);
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
        }

        .toc-title {
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .toc-list {
            list-style: none;
        }

        .toc-list a {
            display: block;
            padding: 0.25rem 0;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            transition: color 0.2s;
        }

        .toc-list a:hover {
            color: var(--primary);
        }

        .toc-list .toc-h2 {
            margin-left: 0;
            font-weight: 500;
        }

        .toc-list .toc-h3 {
            margin-left: 1rem;
            font-size: 0.8125rem;
        }

        .toc-list .toc-h4 {
            margin-left: 2rem;
            font-size: 0.75rem;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        h2 {
            font-size: 1.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border);
            color: var(--text-primary);
        }

        h3 {
            font-size: 1.25rem;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        h4 {
            font-size: 1.125rem;
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        p {
            margin-bottom: 1rem;
        }

        ul, ol {
            margin-bottom: 1rem;
            padding-left: 2rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        code {
            background: var(--bg-light);
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.875rem;
        }

        pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin-bottom: 1rem;
        }

        pre code {
            background: transparent;
            padding: 0;
            color: inherit;
        }

        blockquote {
            border-left: 4px solid var(--primary);
            padding-left: 1rem;
            margin: 1rem 0;
            color: var(--text-secondary);
            font-style: italic;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
        }

        th, td {
            border: 1px solid var(--border);
            padding: 0.75rem;
            text-align: left;
        }

        th {
            background: var(--bg-light);
            font-weight: 600;
        }

        a {
            color: var(--primary);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        hr {
            border: none;
            border-top: 1px solid var(--border);
            margin: 2rem 0;
        }

        img {
            max-width: 600px;
            height: auto;
            border-radius: 0.5rem;
            border: 1px solid var(--border);
            margin: 1rem 0;
            display: block;
        }

        .mermaid {
            background: var(--bg-white);
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1.5rem 0;
            display: flex;
            justify-content: center;
            border: 1px solid var(--border);
            max-width: 800px;
            overflow-x: auto;
        }

        .mermaid svg {
            max-width: 100%;
            max-height: 500px;
            height: auto;
            transform: scale(0.85);
            transform-origin: top center;
        }

        @media (max-width: 1024px) {
            .sidebar {
                display: none;
            }

            .main-content {
                margin-left: 0;
                max-width: 100%;
            }

            .toc-sidebar {
                display: none;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';

        // Initialize Mermaid with enhanced configuration
        mermaid.initialize({
            startOnLoad: false,
            theme: 'default',
            themeVariables: {
                primaryColor: '#2563eb',
                primaryTextColor: '#0f172a',
                primaryBorderColor: '#1e40af',
                lineColor: '#64748b',
                secondaryColor: '#10b981',
                tertiaryColor: '#f59e0b',
                background: '#ffffff',
                mainBkg: '#f8fafc',
                secondBkg: '#e2e8f0',
                border1: '#cbd5e1',
                border2: '#94a3b8'
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            },
            sequence: {
                useMaxWidth: true,
                wrap: true
            },
            gantt: {
                useMaxWidth: true
            }
        });

        // Expose mermaid globally and signal it's ready
        window.mermaid = mermaid;
        window.mermaidReady = true;

        // Dispatch event when mermaid is ready
        window.dispatchEvent(new Event('mermaidLoaded'));
    </script>
</head>
<body>
    <aside class="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="back-link">‚Üê All Modules</a>
            <h1>Dashboard</h1>
        </div>

        <nav>
            <div class="nav-section">
                <h3>Navigation</h3>
                <ul>
                    <li><a href="../index.html">Module Overview</a></li>
                    <li><a href="../index.html#features">Features</a></li>
                </ul>
            </div>
        </nav>
    </aside>

    <div class="main-content">
        <div class="breadcrumb"><a href="../index.html">Documentation</a> / <a href="../index.html">DASHBOARD</a></div>

        <div class="content-wrapper">
            <div class="document-content" id="markdown-content"></div>

            <aside class="toc-sidebar">
                <div class="toc-sticky">
                    <div class="toc-title">On This Page</div>
                    <ul class="toc-list" id="toc-list"></ul>
                </div>
            </aside>
        </div>
    </div>

    <script>
        const markdownContent = "# Dashboard Module Documentation\n\n## Overview\n\nThe Dashboard module serves as the primary landing page and command center for the Carmen ERP system. It provides a comprehensive overview of key metrics, recent activities, and actionable insights across procurement, inventory, and operational domains.\n\n## Module Information\n\n- **Module Name**: Dashboard\n- **Route**: `/dashboard`\n- **Access Level**: All authenticated users (role-based content visibility)\n- **Primary Purpose**: Executive overview and quick access to system metrics\n\n## Key Features\n\n### 1. Main Metrics Dashboard Cards\n- **Total Orders**: Display total purchase orders for the current month with trend analysis\n- **Active Suppliers**: Show count of verified active suppliers with growth percentage\n- **Inventory Value**: Current stock valuation with change indicators\n- **Monthly Spend**: Total procurement expenditure with trend comparison\n\n### 2. Status Cards\n- **Critical Stock Items**: Alert for items below minimum threshold\n- **Orders Pending Approval**: Count of orders awaiting manager approval\n- **Completed Deliveries**: Weekly delivery completion metrics\n\n### 3. Data Visualization Charts\n- **Order Trends**: Area chart showing 6-month purchase order trends\n- **Spend Analysis**: Bar chart displaying monthly procurement spend\n- **Supplier Network Growth**: Line chart correlating supplier count with order volume\n\n### 4. Recent Activities Table\n- Real-time activity feed showing latest procurement and inventory operations\n- Displays: Purchase Requests, Purchase Orders, Goods Receipts, Stock Adjustments, Vendor Invoices, Quality Checks\n- Action menu for each activity (View, Edit, Delete)\n\n### 5. Search and Navigation\n- Global search functionality in header\n- Quick access to notifications\n- Settings access\n- Sidebar navigation toggle\n\n## Page Structure\n\n### Header Component\n**File**: `/app/(main)/dashboard/components/dashboard-header.tsx`\n\n**Features**:\n- Sidebar toggle button\n- Page title: \"Hotel Supply Chain Dashboard\"\n- Search bar (hidden on mobile)\n- Notification bell icon\n- Settings icon\n\n### Metric Cards Component\n**File**: `/app/(main)/dashboard/components/dashboard-cards.tsx`\n\n**Main Metrics**:\n1. Total Orders\n   - Value display with icon\n   - Percentage change with trend indicator\n   - Description text\n\n2. Active Suppliers\n   - Count display with icon\n   - Growth percentage\n   - Verification status\n\n3. Inventory Value\n   - Dollar value with icon\n   - Change percentage\n   - Current stock context\n\n4. Monthly Spend\n   - Total spend display\n   - Percentage change\n   - Procurement context\n\n**Status Indicators**:\n1. Critical Stock Items\n   - Badge with count\n   - Alert status (red)\n   - Threshold description\n\n2. Orders Pending Approval\n   - Badge with count\n   - Warning status (yellow)\n   - Approval context\n\n3. Completed Deliveries\n   - Badge with count\n   - Success status (green)\n   - Time period (weekly)\n\n### Chart Component\n**File**: `/app/(main)/dashboard/components/dashboard-chart.tsx`\n\n**Visualizations**:\n\n1. **Order Trends** (Area Chart)\n   - Data: 6-month monthly orders\n   - Type: Area chart with gradient fill\n   - Metrics: Order count by month\n\n2. **Spend Analysis** (Bar Chart)\n   - Data: Monthly procurement spend (in thousands)\n   - Type: Bar chart with rounded corners\n   - Metrics: Dollar value by month\n\n3. **Supplier Network Growth** (Line Chart)\n   - Data: Supplier count and order volume correlation\n   - Type: Dual-line chart\n   - Metrics: Suppliers and orders over time\n\n### Data Table Component\n**File**: `/app/(main)/dashboard/components/dashboard-data-table.tsx`\n\n**Columns**:\n- Type: Activity type (Purchase Request, Purchase Order, etc.)\n- Document: Document ID with reference number\n- Target: Associated entity (supplier, department, etc.)\n- Status: Current status with color-coded badge\n- Priority: Priority level with color coding\n- Reviewer: Assigned reviewer name\n- Date: Activity date\n- Actions: Dropdown menu with operations\n\n**Status Colors**:\n- Approved/Complete: Green\n- Processing/Pending: Yellow\n- Under Review: Blue\n- Failed: Red\n\n**Priority Colors**:\n- Critical: Red\n- High: Orange\n- Medium: Yellow\n- Low: Green\n\n**Actions Menu**:\n- View details\n- Edit\n- Delete (destructive action)\n\n## Data Flow\n\n### Static Data\nCurrently using mock data for demonstration:\n- Chart data: 6 months of aggregated metrics\n- Activity data: Recent 6 activities with various types\n\n### Future Integration Points\n1. **Real-time Metrics API**\n   - Endpoint: `/api/dashboard/metrics`\n   - Updates: Total orders, suppliers, inventory value, spend\n\n2. **Activity Stream API**\n   - Endpoint: `/api/dashboard/activities`\n   - Pagination support\n   - Real-time updates via WebSocket\n\n3. **Chart Data API**\n   - Endpoint: `/api/dashboard/charts`\n   - Time range filtering\n   - Aggregation by period\n\n## State Management\n\n### Client-Side State\n- Chart configuration\n- Table sorting and filtering\n- Search query\n- Selected time periods\n\n### Server State\n- Dashboard metrics\n- Recent activities\n- User preferences\n- Role-based visibility rules\n\n## User Interactions\n\n### Available Actions\n1. **Search**: Global search across entities\n2. **View Details**: Navigate to activity detail pages\n3. **Edit**: Modify activities (permission-based)\n4. **Delete**: Remove activities (permission-based)\n5. **Notifications**: View system notifications\n6. **Settings**: Access user/system settings\n\n### Navigation Flows\n1. Dashboard ‚Üí Activity Details (via table actions)\n2. Dashboard ‚Üí Module Pages (via sidebar)\n3. Dashboard ‚Üí Search Results (via search bar)\n4. Dashboard ‚Üí Notifications (via bell icon)\n5. Dashboard ‚Üí Settings (via settings icon)\n\n## Responsive Design\n\n### Breakpoints\n- **Mobile** (< 768px): Stacked layout, hidden search\n- **Tablet** (768px - 1024px): 2-column grid for cards\n- **Desktop** (> 1024px): 4-column grid, full features\n\n### Mobile Adaptations\n- Sidebar converts to sheet overlay\n- Search hidden, accessible via icon\n- Cards stack vertically\n- Charts maintain readability\n- Table scrolls horizontally\n\n## Accessibility\n\n### ARIA Labels\n- Sidebar trigger: \"Toggle sidebar\"\n- Search input: \"Search...\"\n- Notification button: \"Notifications\"\n- Settings button: \"Settings\"\n- Action buttons: Descriptive labels\n\n### Keyboard Navigation\n- Tab order follows visual hierarchy\n- Dropdown menus keyboard accessible\n- Chart tooltips accessible via keyboard\n- Table rows focusable\n\n### Screen Reader Support\n- Semantic HTML structure\n- Proper heading hierarchy (h1 for title)\n- Status indicators announced\n- Chart data accessible via table fallback\n\n## Performance Considerations\n\n### Optimization Strategies\n1. **Client Components**: Charts and interactive elements only\n2. **Static Rendering**: Header and card structure\n3. **Code Splitting**: Chart library lazy loaded\n4. **Image Optimization**: Icons via Lucide (tree-shakeable)\n\n### Loading States\n- Skeleton loaders for metrics\n- Progressive chart rendering\n- Incremental table loading\n- Optimistic UI updates\n\n## Security & Permissions\n\n### Access Control\n- All users can view dashboard\n- Edit/Delete actions require specific permissions\n- Metrics filtered by user role and department\n- Sensitive data masked based on clearance level\n\n### Data Visibility Rules\n1. **Staff**: Own department metrics only\n2. **Department Manager**: Department-wide metrics\n3. **Financial Manager**: Full financial visibility\n4. **Purchasing Staff**: Procurement metrics\n5. **Executive**: Full system visibility\n\n## Integration Points\n\n### Connected Modules\n1. **Procurement**: Purchase requests, orders, GRN\n2. **Inventory Management**: Stock levels, adjustments\n3. **Vendor Management**: Supplier data\n4. **Reporting & Analytics**: Chart data sources\n5. **Finance**: Spend analysis\n\n### Shared Components\n- UI components from `/components/ui`\n- Chart components from shadcn/ui\n- Icon library: Lucide React\n\n## Future Enhancements\n\n### Planned Features\n1. **Customizable Widgets**: User-configurable dashboard layout\n2. **Real-time Updates**: WebSocket integration for live metrics\n3. **Advanced Filtering**: Date range, department, status filters\n4. **Export Functionality**: PDF/Excel export of metrics\n5. **Drill-down Analytics**: Click-through to detailed reports\n6. **Alert Management**: Configurable threshold alerts\n7. **Multi-location Support**: Location-specific dashboards\n8. **Comparative Analysis**: Period-over-period comparisons\n\n### Technical Debt\n1. Replace mock data with API integration\n2. Implement proper error boundaries\n3. Add comprehensive loading states\n4. Enhance mobile table experience\n5. Add unit and integration tests\n\n## Testing Strategy\n\n### Unit Tests\n- Component rendering\n- Data transformation functions\n- Status/priority color mapping\n- Chart data formatting\n\n### Integration Tests\n- User interaction flows\n- Navigation between components\n- Search functionality\n- Action menu operations\n\n### E2E Tests\n- Dashboard load performance\n- Chart rendering accuracy\n- Table pagination and sorting\n- Cross-module navigation\n\n## Related Documentation\n\n- [Purchase Request Module](../pr/README.md)\n- [Purchase Order Module](../po/README.md)\n- [Inventory Management](../inv/README.md)\n- [Vendor Management](../vm/README.md)\n- [User Context System](/lib/context/user-context.tsx)\n\n## Maintenance Notes\n\n### Last Updated\n- Documentation: 2025-10-02\n- Code Version: Latest (check git log for specific commits)\n\n### Known Issues\n1. Mock data needs API integration\n2. Real-time updates not implemented\n3. Mobile table UX needs improvement\n4. Chart performance with large datasets untested\n\n### Change Log\n- Initial implementation: Dashboard structure and components\n- Added responsive design support\n- Implemented chart visualizations\n- Created activity table with actions\n";

        // Configure marked
        marked.setOptions({
            highlight: function(code, lang) {
                return code;
            },
            breaks: true,
            gfm: true
        });

        // Render markdown
        const contentDiv = document.getElementById('markdown-content');
        contentDiv.innerHTML = marked.parse(markdownContent);

        // Function to render Mermaid diagrams
        function renderMermaidDiagrams() {
            if (!window.mermaid) {
                console.log('Mermaid not loaded yet, waiting...');
                return;
            }

            // Find all code blocks with mermaid language
            const mermaidBlocks = contentDiv.querySelectorAll('pre code.language-mermaid, pre code[class*="mermaid"]');

            if (mermaidBlocks.length === 0) {
                console.log('No mermaid blocks found');
                return;
            }

            console.log('Found', mermaidBlocks.length, 'mermaid blocks');

            mermaidBlocks.forEach((block, index) => {
                const mermaidCode = block.textContent;
                const pre = block.parentElement;

                // Create a div for mermaid diagram
                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = mermaidCode;
                mermaidDiv.id = 'mermaid-diagram-' + index;

                // Replace the pre block with mermaid div
                pre.replaceWith(mermaidDiv);
            });

            // Run mermaid rendering
            window.mermaid.run({
                querySelector: '.mermaid'
            }).then(() => {
                console.log('Mermaid diagrams rendered successfully');
            }).catch(err => {
                console.error('Mermaid rendering error:', err);
            });
        }

        // Wait for mermaid to load before rendering
        if (window.mermaidReady) {
            renderMermaidDiagrams();
        } else {
            window.addEventListener('mermaidLoaded', renderMermaidDiagrams);
            // Fallback timeout
            setTimeout(renderMermaidDiagrams, 1000);
        }

        // Generate TOC from headings
        const tocList = document.getElementById('toc-list');
        const headings = contentDiv.querySelectorAll('h2, h3, h4');

        headings.forEach((heading, index) => {
            const id = 'heading-' + index;
            heading.id = id;

            const li = document.createElement('li');
            const a = document.createElement('a');
            a.href = '#' + id;
            a.textContent = heading.textContent;
            a.className = 'toc-' + heading.tagName.toLowerCase();

            li.appendChild(a);
            tocList.appendChild(li);
        });

        // Highlight active TOC item on scroll
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const id = entry.target.id;
                    tocList.querySelectorAll('a').forEach(a => {
                        a.style.color = a.getAttribute('href') === '#' + id ? 'var(--primary)' : 'var(--text-secondary)';
                        a.style.fontWeight = a.getAttribute('href') === '#' + id ? '600' : '400';
                    });
                }
            });
        }, { threshold: 1.0 });

        headings.forEach(heading => observer.observe(heading));
    </script>
</body>
</html>