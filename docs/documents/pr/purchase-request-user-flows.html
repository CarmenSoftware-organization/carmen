<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Purchase Request User Flows - Carmen ERP Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --secondary: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg-light: #f8fafc;
            --bg-white: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: var(--bg-light);
            color: var(--text-primary);
            line-height: 1.6;
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background: var(--bg-white);
            border-right: 1px solid var(--border);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            padding: 2rem 0;
        }

        .sidebar-header {
            padding: 0 1.5rem;
            margin-bottom: 2rem;
        }

        .sidebar-header h1 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .back-link:hover {
            color: var(--primary);
        }

        .sidebar nav {
            padding: 0 1rem;
        }

        .nav-section {
            margin-bottom: 1.5rem;
        }

        .nav-section h3 {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            padding: 0 0.5rem;
            margin-bottom: 0.5rem;
        }

        .nav-section ul {
            list-style: none;
        }

        .nav-section a {
            display: block;
            padding: 0.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .nav-section a:hover,
        .nav-section a.active {
            background: var(--bg-light);
            color: var(--primary);
        }

        .main-content {
            margin-left: 280px;
            flex: 1;
            padding: 2rem;
            max-width: calc(100% - 280px);
        }

        .breadcrumb {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .breadcrumb a {
            color: var(--primary);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .content-wrapper {
            display: flex;
            gap: 2rem;
        }

        .document-content {
            flex: 1;
            background: var(--bg-white);
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
            min-width: 0;
        }

        .toc-sidebar {
            width: 250px;
            flex-shrink: 0;
        }

        .toc-sticky {
            position: sticky;
            top: 2rem;
            background: var(--bg-white);
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
        }

        .toc-title {
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .toc-list {
            list-style: none;
        }

        .toc-list a {
            display: block;
            padding: 0.25rem 0;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            transition: color 0.2s;
        }

        .toc-list a:hover {
            color: var(--primary);
        }

        .toc-list .toc-h2 {
            margin-left: 0;
            font-weight: 500;
        }

        .toc-list .toc-h3 {
            margin-left: 1rem;
            font-size: 0.8125rem;
        }

        .toc-list .toc-h4 {
            margin-left: 2rem;
            font-size: 0.75rem;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        h2 {
            font-size: 1.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border);
            color: var(--text-primary);
        }

        h3 {
            font-size: 1.25rem;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        h4 {
            font-size: 1.125rem;
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        p {
            margin-bottom: 1rem;
        }

        ul, ol {
            margin-bottom: 1rem;
            padding-left: 2rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        code {
            background: var(--bg-light);
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.875rem;
        }

        pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin-bottom: 1rem;
        }

        pre code {
            background: transparent;
            padding: 0;
            color: inherit;
        }

        blockquote {
            border-left: 4px solid var(--primary);
            padding-left: 1rem;
            margin: 1rem 0;
            color: var(--text-secondary);
            font-style: italic;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
        }

        th, td {
            border: 1px solid var(--border);
            padding: 0.75rem;
            text-align: left;
        }

        th {
            background: var(--bg-light);
            font-weight: 600;
        }

        a {
            color: var(--primary);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        hr {
            border: none;
            border-top: 1px solid var(--border);
            margin: 2rem 0;
        }

        img {
            max-width: 600px;
            height: auto;
            border-radius: 0.5rem;
            border: 1px solid var(--border);
            margin: 1rem 0;
            display: block;
        }

        .mermaid {
            background: var(--bg-white);
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1.5rem 0;
            display: flex;
            justify-content: center;
            border: 1px solid var(--border);
            max-width: 800px;
            overflow-x: auto;
        }

        .mermaid svg {
            max-width: 100%;
            max-height: 500px;
            height: auto;
            transform: scale(0.85);
            transform-origin: top center;
        }

        @media (max-width: 1024px) {
            .sidebar {
                display: none;
            }

            .main-content {
                margin-left: 0;
                max-width: 100%;
            }

            .toc-sidebar {
                display: none;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';

        // Initialize Mermaid with enhanced configuration
        mermaid.initialize({
            startOnLoad: false,
            theme: 'default',
            themeVariables: {
                primaryColor: '#2563eb',
                primaryTextColor: '#0f172a',
                primaryBorderColor: '#1e40af',
                lineColor: '#64748b',
                secondaryColor: '#10b981',
                tertiaryColor: '#f59e0b',
                background: '#ffffff',
                mainBkg: '#f8fafc',
                secondBkg: '#e2e8f0',
                border1: '#cbd5e1',
                border2: '#94a3b8'
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            },
            sequence: {
                useMaxWidth: true,
                wrap: true
            },
            gantt: {
                useMaxWidth: true
            }
        });

        // Expose mermaid globally and signal it's ready
        window.mermaid = mermaid;
        window.mermaidReady = true;

        // Dispatch event when mermaid is ready
        window.dispatchEvent(new Event('mermaidLoaded'));
    </script>
</head>
<body>
    <aside class="sidebar">
        <div class="sidebar-header">
            <a href="../index.html" class="back-link">‚Üê All Modules</a>
            <h1>Purchase Requests</h1>
        </div>

        <nav>
            <div class="nav-section">
                <h3>Navigation</h3>
                <ul>
                    <li><a href="../index.html">Module Overview</a></li>
                    <li><a href="../index.html#features">Features</a></li>
                </ul>
            </div>
        </nav>
    </aside>

    <div class="main-content">
        <div class="breadcrumb"><a href="../index.html">Documentation</a> / <a href="../index.html">PR</a></div>

        <div class="content-wrapper">
            <div class="document-content" id="markdown-content"></div>

            <aside class="toc-sidebar">
                <div class="toc-sticky">
                    <div class="toc-title">On This Page</div>
                    <ul class="toc-list" id="toc-list"></ul>
                </div>
            </aside>
        </div>
    </div>

    <script>
        const markdownContent = "# Purchase Request User Flows\n\nThis document details all user interaction flows within the Purchase Request system, including role-based workflows, UI interactions, and business process flows.\n\n## User Role Definitions\n\n```mermaid\ngraph TD\n    subgraph \"User Roles & Responsibilities\"\n        A[\"üë§ Requestor\"] --> B[\"üìù Create PRs<br/>üìã Track Status<br/>üí¨ Respond to Returns\"]\n        C[\"üë®‚Äçüíº Department Manager\"] --> D[\"‚úÖ Approve Department PRs<br/>‚ùå Reject with Comments<br/>üîÑ Return for Changes\"]\n        E[\"üí∞ Finance Manager\"] --> F[\"üí≥ Budget Validation<br/>üí∞ Financial Approval<br/>üìä Cost Analysis\"]\n        G[\"üõí Purchasing Staff\"] --> H[\"üè™ Vendor Management<br/>üí≤ Price Negotiation<br/>üì¶ Order Processing\"]\n        I[\"üëî General Manager\"] --> J[\"üíé High-Value Approvals<br/>üéØ Strategic Decisions<br/>üìà Executive Oversight\"]\n    end\n```\n\n## Main User Journey Map\n\n```mermaid\njourney\n    title Purchase Request User Journey\n    section Requestor\n        Login to System          : 5: Requestor\n        Navigate to PRs          : 4: Requestor\n        Create New PR            : 3: Requestor\n        Fill Item Details        : 2: Requestor\n        Submit for Approval      : 4: Requestor\n        Wait for Response        : 3: Requestor\n        Receive Approval         : 5: Requestor\n\n    section Manager\n        Review Pending PRs       : 4: Manager\n        Open PR for Review       : 3: Manager\n        Check Budget Impact      : 2: Manager\n        Make Approval Decision   : 3: Manager\n        Add Comments if Needed   : 2: Manager\n        Submit Decision          : 4: Manager\n\n    section Finance\n        Review Financial Impact  : 3: Finance\n        Validate Budget Codes    : 2: Finance\n        Check Spending Limits    : 3: Finance\n        Approve or Escalate      : 4: Finance\n\n    section Purchasing\n        Receive Approved PRs     : 4: Purchasing\n        Contact Vendors          : 3: Purchasing\n        Negotiate Pricing        : 2: Purchasing\n        Create Purchase Orders   : 4: Purchasing\n        Complete Process         : 5: Purchasing\n```\n\n## Create Purchase Request Flow\n\n```mermaid\nflowchart TD\n    A[\"üöÄ Start: User wants to create PR\"] --> B[\"Click 'Create Purchase Request'\"]\n    B --> C[\"üìã Template Selection Modal\"]\n\n    C --> D{Select Template Type}\n    D -->|\"üè¢ Office Supplies\"| E[\"Office Template\"]\n    D -->|\"üíª IT Equipment\"| F[\"IT Template\"]\n    D -->|\"üçΩÔ∏è Kitchen/F&B\"| G[\"Kitchen Template\"]\n    D -->|\"üîß Maintenance\"| H[\"Maintenance Template\"]\n    D -->|\"üìù Custom/Blank\"| I[\"Blank Form\"]\n\n    E --> J[\"Pre-filled with Common Office Items\"]\n    F --> K[\"Pre-filled with IT Categories\"]\n    G --> L[\"Pre-filled with F&B Items\"]\n    H --> M[\"Pre-filled with Maintenance Items\"]\n    I --> N[\"Empty Form\"]\n\n    J --> O[\"üìù PR Form Page\"]\n    K --> O\n    L --> O\n    M --> O\n    N --> O\n\n    O --> P[\"Fill Basic Information\"]\n    P --> Q[\"üì¶ Add Items Section\"]\n\n    Q --> R{Add More Items?}\n    R -->|\"Yes\"| S[\"‚ûï Add Item Modal\"]\n    S --> T[\"Fill Item Details\"]\n    T --> U[\"üíæ Save Item\"]\n    U --> R\n\n    R -->|\"No\"| V[\"üìä Review Summary\"]\n    V --> W{Validation Check}\n    W -->|\"‚ùå Errors\"| X[\"üö® Show Validation Errors\"]\n    X --> P\n\n    W -->|\"‚úÖ Valid\"| Y{Save Action}\n    Y -->|\"üíæ Save as Draft\"| Z[\"Save Draft State\"]\n    Y -->|\"üì§ Submit for Approval\"| AA[\"Submit to Workflow\"]\n\n    Z --> BB[\"üìç Redirect to PR List\"]\n    AA --> CC[\"üîÑ Workflow Engine Processing\"]\n    CC --> DD[\"üìß Send Notifications\"]\n    DD --> EE[\"üìç Redirect to PR Detail\"]\n```\n\n## Purchase Request Detail View Flow\n\n```mermaid\nflowchart TD\n    A[\"üîó Access PR Detail\"] --> B[\"Load PR Data\"]\n    B --> C[\"üîê Check User Permissions\"]\n    C --> D[\"üìã Render PR Header\"]\n    D --> E[\"üìä Display Workflow Progress\"]\n    E --> F[\"üìë Initialize Tab System\"]\n\n    F --> G{Default Tab Selection}\n    G -->|\"Items\"| H[\"üì¶ Items Tab Active\"]\n    G -->|\"Budget\"| I[\"üí∞ Budget Tab Active\"]\n    G -->|\"Workflow\"| J[\"üîÑ Workflow Tab Active\"]\n\n    H --> K[\"üìã Items Data Table\"]\n    K --> L[\"üéØ Row Actions Available\"]\n    L --> M{User Action on Item}\n    M -->|\"Edit\"| N[\"‚úèÔ∏è Edit Item Modal\"]\n    M -->|\"Vendor Compare\"| O[\"üè™ Vendor Comparison Modal\"]\n    M -->|\"Price History\"| P[\"üìà Price History Modal\"]\n    M -->|\"Delete\"| Q[\"‚ùå Delete Confirmation\"]\n\n    I --> R[\"üí≥ Budget Allocation View\"]\n    R --> S[\"üìä Spending Analysis\"]\n    R --> T[\"‚ö†Ô∏è Budget Warnings\"]\n\n    J --> U[\"üîÑ Workflow Timeline\"]\n    U --> V[\"üìù Approval Comments\"]\n    U --> W[\"üéØ Available Actions\"]\n\n    W --> X{Workflow Action}\n    X -->|\"Approve\"| Y[\"‚úÖ Approval Confirmation\"]\n    X -->|\"Reject\"| Z[\"‚ùå Rejection with Comments\"]\n    X -->|\"Return\"| AA[\"üîÑ Return Step Selector\"]\n\n    Y --> BB[\"üîÑ Update Workflow State\"]\n    Z --> BB\n    AA --> BB\n    BB --> CC[\"üìß Send Notifications\"]\n    CC --> DD[\"üîÑ Refresh Page Data\"]\n```\n\n## Approval Workflow Decision Tree\n\n```mermaid\nflowchart TD\n    A[\"üì§ PR Submitted\"] --> B[\"üîÑ Workflow Engine Analysis\"]\n    B --> C[\"üí∞ Calculate Total Value\"]\n    C --> D[\"üìã Analyze Item Categories\"]\n    D --> E[\"üéØ Determine Approval Path\"]\n\n    E --> F{Value Threshold Check}\n    F -->|\"< $1,000\"| G[\"üöÄ Auto-Approve to Purchasing\"]\n    F -->|\"$1,000 - $5,000\"| H[\"üë®‚Äçüíº Department Manager Required\"]\n    F -->|\"$5,000 - $10,000\"| I[\"üí∞ Finance Manager Required\"]\n    F -->|\"> $10,000\"| J[\"üëî GM Approval Required\"]\n\n    H --> K{Manager Decision}\n    K -->|\"‚úÖ Approve\"| L[\"Check Next Stage\"]\n    K -->|\"‚ùå Reject\"| M[\"üìß Rejection Notification\"]\n    K -->|\"üîÑ Return\"| N[\"üìß Return Notification\"]\n\n    I --> O{Finance Decision}\n    O -->|\"‚úÖ Approve\"| L\n    O -->|\"‚ùå Reject\"| M\n    O -->|\"üîÑ Return\"| N\n\n    J --> P{GM Decision}\n    P -->|\"‚úÖ Approve\"| L\n    P -->|\"‚ùå Reject\"| M\n    P -->|\"üîÑ Return\"| N\n\n    L --> Q{Special Categories?}\n    Q -->|\"üíª IT Equipment\"| R[\"üîß IT Manager Approval\"]\n    Q -->|\"üîí Controlled Items\"| S[\"üìã Compliance Check\"]\n    Q -->|\"üè¢ Standard Items\"| T[\"üõí Route to Purchasing\"]\n\n    G --> T\n    R --> U{IT Manager Decision}\n    U -->|\"‚úÖ Approve\"| T\n    U -->|\"‚ùå Reject\"| M\n    U -->|\"üîÑ Return\"| N\n\n    S --> V{Compliance Check}\n    V -->|\"‚úÖ Pass\"| T\n    V -->|\"‚ùå Fail\"| W[\"üìã Additional Documentation Required\"]\n    W --> X[\"üìß Documentation Request\"]\n\n    T --> Y[\"üõí Purchasing Queue\"]\n    Y --> Z[\"‚úÖ Process Complete\"]\n```\n\n## Bulk Operations Flow\n\n```mermaid\nflowchart TD\n    A[\"‚òëÔ∏è Select Multiple PRs\"] --> B[\"üéØ Bulk Actions Menu\"]\n    B --> C{Select Bulk Action}\n\n    C -->|\"‚úÖ Bulk Approve\"| D[\"Validate Permissions\"]\n    C -->|\"‚ùå Bulk Reject\"| E[\"Collect Rejection Comments\"]\n    C -->|\"üîÑ Bulk Return\"| F[\"Select Return Stage\"]\n    C -->|\"üìä Bulk Export\"| G[\"Export Configuration\"]\n    C -->|\"üóëÔ∏è Bulk Delete\"| H[\"Delete Confirmation\"]\n\n    D --> I{Mixed Status Check}\n    I -->|\"‚ö†Ô∏è Mixed Statuses\"| J[\"üö® Mixed Status Warning\"]\n    I -->|\"‚úÖ Consistent\"| K[\"üìã Bulk Approval Confirmation\"]\n\n    J --> L[\"üéØ Action Selection per PR\"]\n    L --> M[\"‚ö†Ô∏è Skip Invalid Items\"]\n    M --> N[\"üìã Process Valid Items\"]\n\n    K --> O[\"üîÑ Process All Items\"]\n    E --> P[\"üí¨ Comment Collection Modal\"]\n    F --> Q[\"üîÑ Stage Selection Modal\"]\n\n    P --> R[\"üìã Apply Comments to All\"]\n    Q --> S[\"üéØ Apply Return Stage to All\"]\n\n    R --> T[\"üîÑ Bulk Rejection Process\"]\n    S --> U[\"üîÑ Bulk Return Process\"]\n    O --> V[\"üîÑ Bulk Approval Process\"]\n\n    T --> W[\"üìß Send Notifications\"]\n    U --> W\n    V --> W\n\n    W --> X[\"üîÑ Refresh Data\"]\n    X --> Y[\"üìä Show Results Summary\"]\n\n    G --> Z[\"üìÑ Generate Export File\"]\n    Z --> AA[\"‚¨áÔ∏è Download File\"]\n\n    H --> BB[\"‚ö†Ô∏è Deletion Warning\"]\n    BB --> CC{Confirm Delete}\n    CC -->|\"‚úÖ Yes\"| DD[\"üóëÔ∏è Delete Items\"]\n    CC -->|\"‚ùå No\"| EE[\"‚ùå Cancel Operation\"]\n    DD --> FF[\"üìß Deletion Notifications\"]\n    FF --> X\n```\n\n## Modal Interaction Flows\n\n### Vendor Comparison Modal\n\n```mermaid\nflowchart TD\n    A[\"üè™ Open Vendor Comparison\"] --> B[\"üìä Load Vendor Data\"]\n    B --> C[\"üí∞ Display Price Grid\"]\n    C --> D[\"‚≠ê Show Vendor Ratings\"]\n    D --> E[\"üìã Display Terms & Conditions\"]\n\n    E --> F{User Interaction}\n    F -->|\"Select Vendor\"| G[\"‚úÖ Highlight Selection\"]\n    F -->|\"Override Price\"| H[\"üí∞ Price Override Input\"]\n    F -->|\"View Details\"| I[\"üìã Vendor Detail Popup\"]\n    F -->|\"Add Notes\"| J[\"üìù Notes Input Field\"]\n\n    G --> K[\"üíæ Save Selection\"]\n    H --> L[\"üîç Validate Override\"]\n    L --> M{Valid Override?}\n    M -->|\"‚úÖ Yes\"| K\n    M -->|\"‚ùå No\"| N[\"üö® Error Message\"]\n    N --> H\n\n    I --> O[\"üìä Vendor Performance History\"]\n    J --> P[\"üí¨ Save Notes\"]\n\n    K --> Q[\"üîÑ Update PR Item\"]\n    P --> Q\n    Q --> R[\"üìß Change Notifications\"]\n    R --> S[\"‚ùå Close Modal\"]\n    S --> T[\"üîÑ Refresh Parent View\"]\n```\n\n### Price History Modal\n\n```mermaid\nflowchart TD\n    A[\"üìà Open Price History\"] --> B[\"üìä Load Historical Data\"]\n    B --> C[\"üìà Render Price Chart\"]\n    C --> D[\"üìã Display Price Table\"]\n    D --> E[\"üè™ Show Vendor Breakdown\"]\n\n    E --> F{User Interaction}\n    F -->|\"Change Date Range\"| G[\"üìÖ Date Range Picker\"]\n    F -->|\"Filter by Vendor\"| H[\"üè™ Vendor Filter\"]\n    F -->|\"Export Data\"| I[\"üìÑ Export Options\"]\n    F -->|\"View Trends\"| J[\"üìä Trend Analysis\"]\n\n    G --> K[\"üîÑ Update Chart Data\"]\n    H --> L[\"üéØ Filter Chart Points\"]\n    I --> M[\"‚¨áÔ∏è Download File\"]\n    J --> N[\"üìä Display Trend Analysis\"]\n\n    K --> O[\"üìà Re-render Chart\"]\n    L --> O\n    N --> P[\"üìã Show Insights\"]\n\n    O --> Q{More Actions?}\n    Q -->|\"Yes\"| F\n    Q -->|\"No\"| R[\"‚ùå Close Modal\"]\n    R --> S[\"üîÑ Return to Parent\"]\n```\n\n## Error Handling and Recovery Flows\n\n```mermaid\nflowchart TD\n    A[\"üö® Error Detected\"] --> B{Error Type Classification}\n\n    B -->|\"üîß Validation Error\"| C[\"üìã Form Field Highlighting\"]\n    B -->|\"üåê Network Error\"| D[\"üîÑ Retry Mechanism\"]\n    B -->|\"üîê Permission Error\"| E[\"üö´ Access Denied Message\"]\n    B -->|\"‚ö†Ô∏è Business Rule Error\"| F[\"üìã Business Rule Explanation\"]\n    B -->|\"üí• Unexpected Error\"| G[\"üö® Generic Error Handler\"]\n\n    C --> H[\"üìù Display Field Errors\"]\n    H --> I[\"üë§ User Correction Required\"]\n    I --> J[\"üîÑ Re-validate on Change\"]\n\n    D --> K[\"‚è∞ Show Retry Button\"]\n    K --> L{User Choice}\n    L -->|\"üîÑ Retry\"| M[\"üîÑ Retry Request\"]\n    L -->|\"‚ùå Cancel\"| N[\"‚ùå Cancel Operation\"]\n    M --> O{Retry Success?}\n    O -->|\"‚úÖ Yes\"| P[\"‚úÖ Continue Normal Flow\"]\n    O -->|\"‚ùå No\"| Q[\"üö® Escalate Error\"]\n\n    E --> R[\"üîê Show Permission Details\"]\n    R --> S[\"üìß Contact Admin Option\"]\n\n    F --> T[\"üìã Show Rule Details\"]\n    T --> U[\"üí° Suggested Actions\"]\n    U --> V[\"üîÑ Return to Form\"]\n\n    G --> W[\"üìß Error Logging\"]\n    W --> X[\"üö® Show Generic Message\"]\n    X --> Y[\"üìû Support Contact Info\"]\n\n    Q --> Z[\"üìä Error Analytics\"]\n    Z --> AA[\"üìß Admin Notification\"]\n```\n\n## Notification System Flow\n\n```mermaid\nflowchart TD\n    A[\"üéØ System Event Triggered\"] --> B{Event Type}\n\n    B -->|\"‚úÖ Success Action\"| C[\"üéâ Success Toast\"]\n    B -->|\"‚ùå Error Action\"| D[\"üö® Error Toast\"]\n    B -->|\"‚ö†Ô∏è Warning\"| E[\"‚ö†Ô∏è Warning Alert\"]\n    B -->|\"‚ÑπÔ∏è Information\"| F[\"‚ÑπÔ∏è Info Banner\"]\n    B -->|\"üìß Workflow Update\"| G[\"üì¨ Email Notification\"]\n\n    C --> H[\"‚è∞ Auto-dismiss Timer (3s)\"]\n    H --> I[\"‚ú® Fade Out Animation\"]\n\n    D --> J[\"üë§ Manual Dismiss Required\"]\n    J --> K[\"‚ùå Close Button\"]\n    K --> L[\"üìä Error Logging\"]\n\n    E --> M[\"‚ö†Ô∏è Action Required Indicator\"]\n    M --> N{User Action}\n    N -->|\"‚úÖ Acknowledge\"| O[\"‚úÖ Clear Warning\"]\n    N -->|\"üîÑ Fix Issue\"| P[\"üîÑ Navigate to Fix\"]\n\n    F --> Q[\"üìç Persistent Display\"]\n    Q --> R{Context Change}\n    R -->|\"üîÑ Page Change\"| S[\"‚ùå Auto Clear\"]\n    R -->|\"üìç Same Context\"| T[\"üìç Keep Visible\"]\n\n    G --> U[\"üìß Email Composition\"]\n    U --> V[\"üì§ Send to Recipients\"]\n    V --> W[\"üìã Delivery Tracking\"]\n\n    I --> X[\"üîÑ Remove from DOM\"]\n    O --> X\n    S --> X\n```\n\n## Search and Filter Flow\n\n```mermaid\nflowchart TD\n    A[\"üîç User Initiates Search\"] --> B{Search Type}\n\n    B -->|\"üìù Quick Search\"| C[\"üîç Search Input Field\"]\n    B -->|\"üéØ Advanced Filter\"| D[\"üìã Filter Panel\"]\n\n    C --> E[\"‚å®Ô∏è Real-time Typing\"]\n    E --> F[\"‚è∞ Debounce (300ms)\"]\n    F --> G[\"üîç Execute Search\"]\n\n    D --> H[\"üìã Filter Categories\"]\n    H --> I[\"üìÖ Date Range\"]\n    H --> J[\"üìä Status Selection\"]\n    H --> K[\"üë§ User Selection\"]\n    H --> L[\"üí∞ Amount Range\"]\n    H --> M[\"üè¢ Department Filter\"]\n\n    I --> N[\"üìÖ Date Picker UI\"]\n    J --> O[\"‚òëÔ∏è Multi-select Checkboxes\"]\n    K --> P[\"üë• User Dropdown\"]\n    L --> Q[\"üí∞ Range Slider\"]\n    M --> R[\"üè¢ Department Dropdown\"]\n\n    G --> S[\"üîÑ Apply Search Query\"]\n    N --> T[\"üéØ Apply Date Filter\"]\n    O --> T\n    P --> T\n    Q --> T\n    R --> T\n\n    S --> U[\"üìä Filter Results\"]\n    T --> U\n\n    U --> V{Results Found?}\n    V -->|\"‚úÖ Yes\"| W[\"üìã Display Results\"]\n    V -->|\"‚ùå No\"| X[\"üì≠ Empty State\"]\n\n    W --> Y[\"üìä Update Result Count\"]\n    X --> Z[\"üí° Search Suggestions\"]\n\n    Y --> AA[\"üìÑ Pagination Update\"]\n    Z --> BB[\"üîÑ Clear Filters Option\"]\n\n    AA --> CC{More Actions?}\n    CC -->|\"Yes\"| DD[\"üîÑ User Continues\"]\n    CC -->|\"No\"| EE[\"‚úÖ Search Complete\"]\n\n    BB --> FF[\"üîÑ Reset to Full List\"]\n    FF --> W\n```\n\n## Mobile Responsive Flows\n\n```mermaid\nflowchart TD\n    A[\"üì± Mobile Device Detection\"] --> B[\"üé® Apply Mobile Styles\"]\n    B --> C[\"üìã Responsive Layout\"]\n\n    C --> D{Screen Size}\n    D -->|\"üì± < 640px\"| E[\"üì± Mobile Layout\"]\n    D -->|\"üìü 640px-1024px\"| F[\"üìü Tablet Layout\"]\n    D -->|\"üñ•Ô∏è > 1024px\"| G[\"üñ•Ô∏è Desktop Layout\"]\n\n    E --> H[\"üçî Hamburger Menu\"]\n    H --> I[\"üìã Collapsible Sidebar\"]\n    I --> J[\"üÉè Card-only View\"]\n    J --> K[\"üì± Touch-friendly Buttons\"]\n\n    F --> L[\"üìü Mixed Layout\"]\n    L --> M[\"üìã Collapsible Panels\"]\n    M --> N[\"üÉè Grid Card View\"]\n\n    G --> O[\"üñ•Ô∏è Full Table View\"]\n    O --> P[\"üìã Extended Sidebar\"]\n    P --> Q[\"üñ±Ô∏è Hover Interactions\"]\n\n    K --> R[\"üëÜ Touch Gestures\"]\n    R --> S[\"üì± Swipe Actions\"]\n    S --> T[\"üìã Pull to Refresh\"]\n\n    N --> U[\"üëÜ Touch & Mouse\"]\n    Q --> V[\"üñ±Ô∏è Desktop Interactions\"]\n\n    T --> W[\"üì± Mobile Optimization\"]\n    U --> X[\"üìü Hybrid Experience\"]\n    V --> Y[\"üñ•Ô∏è Full Feature Set\"]\n\n    W --> Z[\"‚úÖ Mobile Flow Complete\"]\n    X --> Z\n    Y --> Z\n```\n\n---\n\nThis comprehensive user flow documentation provides detailed insight into all user interactions within the Purchase Request system, covering every aspect from basic navigation to complex workflow approvals and error handling scenarios.";

        // Configure marked
        marked.setOptions({
            highlight: function(code, lang) {
                return code;
            },
            breaks: true,
            gfm: true
        });

        // Render markdown
        const contentDiv = document.getElementById('markdown-content');
        contentDiv.innerHTML = marked.parse(markdownContent);

        // Function to render Mermaid diagrams
        function renderMermaidDiagrams() {
            if (!window.mermaid) {
                console.log('Mermaid not loaded yet, waiting...');
                return;
            }

            // Find all code blocks with mermaid language
            const mermaidBlocks = contentDiv.querySelectorAll('pre code.language-mermaid, pre code[class*="mermaid"]');

            if (mermaidBlocks.length === 0) {
                console.log('No mermaid blocks found');
                return;
            }

            console.log('Found', mermaidBlocks.length, 'mermaid blocks');

            mermaidBlocks.forEach((block, index) => {
                const mermaidCode = block.textContent;
                const pre = block.parentElement;

                // Create a div for mermaid diagram
                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = mermaidCode;
                mermaidDiv.id = 'mermaid-diagram-' + index;

                // Replace the pre block with mermaid div
                pre.replaceWith(mermaidDiv);
            });

            // Run mermaid rendering
            window.mermaid.run({
                querySelector: '.mermaid'
            }).then(() => {
                console.log('Mermaid diagrams rendered successfully');
            }).catch(err => {
                console.error('Mermaid rendering error:', err);
            });
        }

        // Wait for mermaid to load before rendering
        if (window.mermaidReady) {
            renderMermaidDiagrams();
        } else {
            window.addEventListener('mermaidLoaded', renderMermaidDiagrams);
            // Fallback timeout
            setTimeout(renderMermaidDiagrams, 1000);
        }

        // Generate TOC from headings
        const tocList = document.getElementById('toc-list');
        const headings = contentDiv.querySelectorAll('h2, h3, h4');

        headings.forEach((heading, index) => {
            const id = 'heading-' + index;
            heading.id = id;

            const li = document.createElement('li');
            const a = document.createElement('a');
            a.href = '#' + id;
            a.textContent = heading.textContent;
            a.className = 'toc-' + heading.tagName.toLowerCase();

            li.appendChild(a);
            tocList.appendChild(li);
        });

        // Highlight active TOC item on scroll
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const id = entry.target.id;
                    tocList.querySelectorAll('a').forEach(a => {
                        a.style.color = a.getAttribute('href') === '#' + id ? 'var(--primary)' : 'var(--text-secondary)';
                        a.style.fontWeight = a.getAttribute('href') === '#' + id ? '600' : '400';
                    });
                }
            });
        }, { threshold: 1.0 });

        headings.forEach(heading => observer.observe(heading));
    </script>
</body>
</html>