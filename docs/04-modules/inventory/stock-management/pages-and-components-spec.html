<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory Management - Pages and Components Specification - Carmen ERP Documentation</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/marked-mermaid@latest/dist/css/marked-mermaid.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked@latest/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@latest/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --secondary: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg-light: #f8fafc;
            --bg-white: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: var(--bg-light);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .section-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background: var(--primary);
            color: white;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .breadcrumb {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .breadcrumb a {
            color: var(--primary);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .back-link {
            display: inline-block;
            color: var(--primary);
            text-decoration: none;
            margin-bottom: 1rem;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        .content {
            background: var(--bg-white);
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: var(--shadow);
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        h2 {
            font-size: 1.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border);
            color: var(--text-primary);
        }

        h3 {
            font-size: 1.25rem;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        h4 {
            font-size: 1.125rem;
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        p {
            margin-bottom: 1rem;
        }

        a {
            color: var(--primary);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        code {
            background: var(--bg-light);
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            font-size: 0.875em;
            font-family: 'Monaco', 'Courier New', monospace;
        }

        pre {
            background: var(--text-primary);
            color: #f8fafc;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin: 1rem 0;
        }

        pre code {
            background: none;
            padding: 0;
            color: inherit;
        }

        ul, ol {
            margin: 1rem 0;
            padding-left: 2rem;
        }

        li {
            margin: 0.5rem 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        th, td {
            padding: 0.75rem;
            text-align: left;
            border: 1px solid var(--border);
        }

        th {
            background: var(--bg-light);
            font-weight: 600;
        }

        blockquote {
            border-left: 4px solid var(--primary);
            padding-left: 1rem;
            margin: 1rem 0;
            color: var(--text-secondary);
        }

        img {
            max-width: 100%;
            height: auto;
            border-radius: 0.5rem;
            margin: 1rem 0;
        }

        .mermaid {
            margin: 1.5rem 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="section-badge">Application Modules</div>
        <div class="breadcrumb"><a href="../../index.html">Documentation</a> / <a href="../index.html">Application Modules</a> / Inventory / Stock Management</div>
        <a href="../../index.html" class="back-link">← Back to Documentation Home</a>
        <div class="content" id="markdown-content"></div>
    </div>
    <script>
        const markdownContent = "# Inventory Management - Pages and Components Specification\n\n## Table of Contents\n1. [Dashboard](#1-dashboard)\n2. [Stock Overview](#2-stock-overview)\n3. [Stock In](#3-stock-in)\n4. [Inventory Adjustments](#4-inventory-adjustments)\n5. [Physical Count](#5-physical-count)\n6. [Spot Check](#6-spot-check)\n7. [Fractional Inventory](#7-fractional-inventory)\n8. [Period End](#8-period-end)\n9. [Physical Count Management](#9-physical-count-management)\n10. [Common Components](#10-common-components)\n\n---\n\n## 1. Dashboard\n\n**Route:** `/inventory-management`\n\n### Purpose\nMain dashboard providing overview of inventory management with customizable widgets.\n\n### Components\n\n#### Main Layout\n- **Header Section**\n  - Page title: \"Inventory Management Dashboard\"\n  - Actions: None\n\n#### Dashboard Grid\n- **Layout**: Drag-and-drop enabled grid (3 columns on desktop, 2 on tablet, 1 on mobile)\n- **Widget System**: React Beautiful DnD for reordering\n\n### Widgets\n\n#### 1.1 Inventory Levels Widget\n**Type:** Bar Chart\n**Data Source:** `inventoryLevelsData`\n**Fields:**\n- Category (X-axis)\n- Current Level (Blue bar)\n- Reorder Point (Green bar)\n\n**Categories:**\n- Food\n- Beverages\n- Cleaning\n- Linen\n- Amenities\n\n#### 1.2 Inventory Value Trend Widget\n**Type:** Line Chart\n**Data Source:** `inventoryValueData`\n**Fields:**\n- Month (X-axis)\n- Value (Y-axis)\n- Time Range: 6 months\n\n#### 1.3 Inventory Turnover Widget\n**Type:** Pie Chart\n**Data Source:** `inventoryTurnoverData`\n**Fields:**\n- Category Name\n- Turnover Rate\n\n#### 1.4 Low Stock Alerts Widget\n**Type:** Text Card\n**Display:**\n- Number of items below reorder point\n- Icon: AlertTriangle\n- Color: Red accent\n\n#### 1.5 Upcoming Stock Takes Widget\n**Type:** Text Card\n**Display:**\n- Count of scheduled stock takes\n- Time frame: Next week\n- Icon: Calendar\n\n#### 1.6 Recent Transfers Widget\n**Type:** Text Card\n**Display:**\n- Number of inter-location transfers\n- Time frame: Last 24 hours\n- Icon: ArrowRightLeft\n\n### Actions\n- **Drag and Drop:** Reorder widgets\n- **Widget Interaction:** Click widgets to drill down (future enhancement)\n\n### Page Flow\n```mermaid\ngraph LR\n    A[Load Dashboard] --> B[Render Widget Grid]\n    B --> C[Display Charts]\n    B --> D[Display Metrics]\n    C --> E[Enable Drag & Drop]\n    D --> E\n```\n\n---\n\n## 2. Stock Overview\n\n**Route:** `/inventory-management/stock-overview`\n\n### Purpose\nComprehensive view of stock levels across all locations with performance analytics and transfer suggestions.\n\n### Layout Sections\n\n#### 2.1 Header Section\n**Components:**\n- Page title: \"Stock Overview\"\n- Subtitle: \"Monitor inventory levels across all locations\"\n- **Location Selector Dropdown**\n  - Options: \"All Locations\" + individual locations\n  - Icon: MapPin\n  - Updates all metrics when changed\n\n#### 2.2 Summary Cards (4 Cards)\n\n**Card 1: Total Items**\n- Icon: Package\n- Value: Total item count (formatted number)\n- Subtitle: \"Across X locations\"\n- Updates based on location filter\n\n**Card 2: Total Value**\n- Icon: TrendingUp\n- Value: Currency formatted total value\n- Subtitle: \"Current inventory value\"\n\n**Card 3: Low Stock**\n- Icon: AlertTriangle\n- Value: Count (red text)\n- Subtitle: \"Items below reorder point\"\n\n**Card 4: Expiring Soon**\n- Icon: Clock\n- Value: Count (orange text)\n- Subtitle: \"Items expiring this week\"\n\n#### 2.3 Tabbed Content\n\n**Tab 1: Overview**\n\n**Stock Distribution Chart**\n- Type: Bar Chart\n- X-axis: Category name\n- Y-axis: Quantity\n- Tooltip: Shows quantity and value\n- Responsive container (300px height)\n\n**Value Distribution Chart**\n- Type: Pie Chart\n- Shows: Category value percentages\n- Labels: Category name + percentage\n- Colors: Cycling color array (6 colors)\n\n**Quick Actions Grid**\n- 4 buttons in grid (2x2 on mobile, 4x1 on desktop)\n- Buttons:\n  1. Inventory Balance (BarChart3 icon)\n  2. Stock Cards (Package icon)\n  3. Slow Moving (Clock icon)\n  4. Inventory Aging (AlertTriangle icon)\n\n**Tab 2: Performance**\n\n**Location Performance Chart**\n- Type: Bar Chart (Grouped)\n- Metrics:\n  - Stock Efficiency %\n  - Turnover Rate\n  - Fill Rate %\n- Height: 400px\n\n**Performance Details Table**\n- Columns:\n  - Location name\n  - Performance badge (excellent/good/average/poor)\n  - Efficiency %\n  - Turnover rate\n  - Fill rate %\n- Card layout with icons\n\n**Tab 3: Transfer Suggestions**\n\n**Suggestion Cards**\n- Display:\n  - Item name\n  - From location → To location\n  - Suggested quantity\n  - Reason (low_stock/expiring/balancing)\n  - Priority badge (high/medium/low)\n  - Potential savings (currency)\n  - \"Create Transfer\" button\n\n### Dropdowns and Filters\n\n**Location Dropdown**\n- Type: Select component\n- Options: All Locations + filtered by user permissions\n- Width: 48 (Tailwind unit)\n\n### Actions\n- Change location filter\n- Navigate to sub-pages (Quick Actions)\n- Create transfer from suggestion\n\n### Data Types\n\n```typescript\ninterface LocationStockData {\n  locationId: string\n  locationName: string\n  categories: CategoryStock[]\n  metrics: LocationMetrics\n}\n\ninterface LocationMetrics {\n  totalItems: number\n  totalValue: { amount: number, currency: string }\n  lowStockCount: number\n  expiringCount: number\n}\n\ninterface TransferSuggestion {\n  itemName: string\n  fromLocation: string\n  toLocation: string\n  suggestedQuantity: number\n  reason: 'low_stock' | 'expiring' | 'balancing'\n  priority: 'high' | 'medium' | 'low'\n  potentialSavings: { amount: number, currency: string }\n}\n```\n\n### Page Flow\n```mermaid\ngraph TD\n    A[Load Page] --> B[Fetch Location Data]\n    B --> C[Apply User Permissions]\n    C --> D[Render Summary Cards]\n    D --> E[Render Charts]\n    E --> F{User Action?}\n    F -->|Change Location| G[Filter Data]\n    F -->|Click Quick Action| H[Navigate to Sub-page]\n    F -->|Create Transfer| I[Open Transfer Form]\n    G --> D\n```\n\n---\n\n## 2.1 Inventory Balance\n\n**Route:** `/inventory-management/stock-overview/inventory-balance`\n\n### Purpose\nDetailed inventory balance report with lot tracking and movement history.\n\n### Components\n\n#### Header Section\n- **Report Title:** \"Inventory Balance Report\"\n- **Filters Panel (Collapsible)**\n  - As of Date picker\n  - Location range (From/To dropdowns)\n  - Category range (From/To dropdowns)\n  - Product range (From/To dropdowns)\n  - View Type radio buttons: Category / Product / Lot\n  - Show Lots checkbox\n\n#### Balance Table\n**Type:** Hierarchical grouped table\n\n**Structure:**\n```\nLocation\n  └─ Category\n      └─ Product\n          └─ Lot (if enabled)\n```\n\n**Columns:**\n- Code\n- Description\n- Unit\n- Quantity\n- Average Cost\n- Total Value\n- Min/Max Thresholds (product level)\n- Expiry Date (lot level)\n\n**Features:**\n- Expandable/collapsible rows\n- Subtotals at each level\n- Grand total row\n- Sort by any column\n- Export to Excel/PDF\n\n#### Movement History Panel\n**Trigger:** Click on product row\n**Display:** Right-side panel or modal\n\n**Columns:**\n- Date\n- Transaction Type\n- Reference\n- Quantity In\n- Quantity Out\n- Balance\n- Notes\n\n### Data Types\n\n```typescript\ninterface BalanceReportParams {\n  asOfDate: string // YYYY-MM-DD\n  locationRange: { from: string; to: string }\n  categoryRange: { from: string; to: string }\n  productRange: { from: string; to: string }\n  viewType: 'CATEGORY' | 'PRODUCT' | 'LOT'\n  showLots: boolean\n}\n\ninterface ProductBalance {\n  id: string\n  code: string\n  name: string\n  unit: string\n  tracking: { batch: boolean }\n  thresholds: { minimum: number; maximum: number }\n  totals: { quantity: number; averageCost: number; value: number }\n  lots: LotBalance[]\n}\n\ninterface LotBalance {\n  lotNumber: string\n  expiryDate?: string\n  quantity: number\n  unitCost: number\n  value: number\n}\n```\n\n### Actions\n- Apply filters\n- Change view type\n- Toggle lot visibility\n- View movement history\n- Export report\n- Print report\n\n---\n\n## 2.2 Stock Cards\n\n**Route:** `/inventory-management/stock-overview/stock-cards`\n\n### Purpose\nBrowse all stock cards with filtering and quick access.\n\n### Components\n\n#### Header\n- Title: \"Stock Cards\"\n- Search box\n- Filter button\n\n#### Filter Panel (Collapsible)\n- Location dropdown\n- Category dropdown\n- Product type checkboxes\n- Stock status filter (In Stock / Low Stock / Out of Stock)\n\n#### Cards Grid\n**Layout:** 3 columns on desktop, 2 on tablet, 1 on mobile\n\n**Card Content:**\n- Product image/icon\n- Product code\n- Product name\n- Current quantity + unit\n- Status badge\n- \"View Details\" button\n\n### Actions\n- Search products\n- Filter by criteria\n- Click card → Navigate to Stock Card Detail\n\n---\n\n## 2.3 Stock Card Detail\n\n**Route:** `/inventory-management/stock-overview/stock-card`\n\n### Purpose\nDetailed view of individual stock card with full movement history and lot information.\n\n### Sections\n\n#### 2.3.1 General Information Panel\n**Fields:**\n- Product Code\n- Product Name\n- Category\n- Unit of Measure\n- Current Stock Level\n- Reorder Level\n- Maximum Level\n- Lead Time (days)\n- Last Purchase Date\n- Last Purchase Price\n- Average Cost\n\n#### 2.3.2 Lot Information Panel (if batch tracked)\n**Table Columns:**\n- Lot Number\n- Receipt Date\n- Expiry Date\n- Quantity\n- Unit Cost\n- Total Value\n- Status (Good/Damaged/Expired)\n\n#### 2.3.3 Movement History Table\n**Columns:**\n- Date/Time\n- Transaction Type (Receipt/Issue/Adjustment/Transfer In/Transfer Out)\n- Reference Number\n- Lot Number (if applicable)\n- Quantity In\n- Quantity Out\n- Balance\n- Unit Cost\n- Value\n- Location (for transfers)\n- User\n- Notes\n\n**Pagination:** 25 items per page\n\n#### 2.3.4 Valuation Panel\n**Displays:**\n- Valuation Method (FIFO/LIFO/Average)\n- Current Total Value\n- Average Unit Cost\n- Last Purchase Cost\n- Cost Variance\n\n### Quick Filters\n**Buttons:**\n- All Transactions\n- Receipts Only\n- Issues Only\n- Adjustments Only\n- Transfers Only\n- Date range picker\n\n### Actions\n- Filter movements by type\n- Filter by date range\n- Export to Excel\n- Print stock card\n- View lot details\n- Create adjustment\n\n### Page Flow\n```mermaid\ngraph TD\n    A[Select Product] --> B[Load General Info]\n    B --> C[Load Lot Info]\n    B --> D[Load Movement History]\n    C --> E[Display Stock Card]\n    D --> E\n    E --> F{User Action?}\n    F -->|Filter| G[Apply Filter]\n    F -->|Export| H[Generate Export]\n    F -->|Create Adjustment| I[Open Adjustment Form]\n    G --> D\n```\n\n---\n\n## 2.4 Slow Moving Items\n\n**Route:** `/inventory-management/stock-overview/slow-moving`\n\n### Purpose\nIdentify slow-moving inventory for action.\n\n### Components\n\n#### Filter Section\n- Time period dropdown (30/60/90/180 days)\n- Category filter\n- Location filter\n- Minimum value filter\n\n#### Slow Moving Table\n**Columns:**\n- Product Code\n- Product Name\n- Category\n- Location\n- Current Quantity\n- Last Movement Date\n- Days Since Movement\n- Current Value\n- Turnover Rate\n- Recommended Action\n\n**Actions Column:**\n- Mark for clearance\n- Create transfer\n- Adjust reorder level\n\n### Features\n- Sort by days since movement\n- Color coding (yellow > 60 days, red > 90 days)\n- Export to Excel\n\n---\n\n## 2.5 Inventory Aging\n\n**Route:** `/inventory-management/stock-overview/inventory-aging`\n\n### Purpose\nTrack inventory age and identify expiring items.\n\n### Components\n\n#### Aging Buckets Table\n**Columns:**\n- Product Code/Name\n- Location\n- Total Quantity\n- 0-30 days qty\n- 31-60 days qty\n- 61-90 days qty\n- 90+ days qty\n- Expiring Soon (< 7 days)\n- Total Value\n\n#### Aging Summary Cards\n- Total Expiring in 7 days (red)\n- Total Expiring in 30 days (orange)\n- Average Age (days)\n- Total Aged Stock Value\n\n### Actions\n- Filter by location\n- Filter by aging bucket\n- Export report\n- Create disposal request\n\n---\n\n## 3. Stock In\n\n**Route:** `/inventory-management/stock-in`\n\n### Purpose\nManage stock receipts from purchase orders and other sources.\n\n### Components\n\n#### 3.1 Stock In List\n**Type:** Data table with filters\n\n**Filter Bar:**\n- Date range picker\n- Status filter (All/Pending/Completed)\n- Location filter\n- Search by reference\n\n**Table Columns:**\n- Receipt Number\n- Receipt Date\n- Source (PO/Transfer/Production)\n- Source Reference\n- Location\n- Total Items\n- Total Quantity\n- Total Value\n- Status\n- Actions (View/Edit/Post)\n\n**Status Badge Colors:**\n- Pending: Yellow\n- Completed: Green\n- Posted: Blue\n\n#### 3.2 Stock In Detail\n\n**Sections:**\n\n**Header Information**\n- Receipt Number (auto-generated)\n- Receipt Date\n- Location dropdown\n- Source type selector (Purchase Order/Transfer/Production/Other)\n- Source reference field\n- Supplier (if from PO)\n- Notes textarea\n\n**Items Table**\n- Columns:\n  - Item Code/Name\n  - Description\n  - Ordered Qty (from source)\n  - Received Qty (editable)\n  - Unit\n  - Unit Cost\n  - Total Cost\n  - Lot Number (if batch tracked)\n  - Expiry Date (if applicable)\n  - Actions (Remove)\n\n**Actions:**\n- Add item button\n- Item lookup modal\n\n**Footer:**\n- Total items count\n- Total quantity\n- Total value\n- Save draft button\n- Post receipt button (final)\n\n### Stock In Journal Entry\n**Auto-generated when posted:**\n```\nDebit: Inventory Account\nCredit: GRN Clearing Account (if from PO)\n       or Source Location (if transfer)\n```\n\n### Actions\n- Create new stock in\n- Edit draft receipt\n- Post receipt → Update inventory\n- View posted receipt\n- Print receipt\n- Cancel receipt\n\n### Page Flow\n```mermaid\ngraph TD\n    A[New Stock In] --> B[Select Source Type]\n    B --> C{Source?}\n    C -->|PO| D[Select PO]\n    C -->|Transfer| E[Select Transfer]\n    C -->|Other| F[Manual Entry]\n    D --> G[Load PO Items]\n    E --> H[Load Transfer Items]\n    F --> I[Add Items Manually]\n    G --> J[Edit Quantities]\n    H --> J\n    I --> J\n    J --> K[Enter Lot/Expiry]\n    K --> L[Review Total]\n    L --> M{Save or Post?}\n    M -->|Save| N[Save as Draft]\n    M -->|Post| O[Post to Inventory]\n    O --> P[Generate Journal Entry]\n```\n\n---\n\n## 4. Inventory Adjustments\n\n**Route:** `/inventory-management/inventory-adjustments`\n\n### Purpose\nRecord inventory adjustments with reasons and automatic journal entry generation.\n\n### Components\n\n#### 4.1 Adjustments List\n\n**Filter Bar:**\n- Date range picker\n- Status filter (Draft/Posted)\n- Adjustment type filter (Positive/Negative/Transfer)\n- Location filter\n- Department filter\n\n**Table Columns:**\n- Adjustment ID\n- Date\n- Type badge (In/Out)\n- Status\n- Location\n- Department\n- Reason\n- Items count\n- Total value\n- Actions (View/Edit/Post/Delete)\n\n#### 4.2 Adjustment Detail Page\n\n**Route:** `/inventory-management/inventory-adjustments/[id]`\n\n**Header Section:**\n- Adjustment ID (auto-generated)\n- Status badge\n- Action buttons (Edit/Post/Delete)\n\n**Information Panel:**\n- Date picker\n- Adjustment type dropdown:\n  - Positive Adjustment (Stock In)\n  - Negative Adjustment (Stock Out)\n  - Transfer\n  - Write-off\n  - Found Stock\n  - Damage\n  - Theft\n  - Expiry\n- Location dropdown\n- Department dropdown\n- Reason dropdown (predefined + custom)\n- Description textarea\n- Reference field\n\n**Stock Movement Table**\n- Columns:\n  - Product Code/Name\n  - SKU\n  - Location\n  - Lot Numbers (expandable)\n  - Quantity\n  - UOM\n  - Unit Cost\n  - Total Cost\n  - Actions (Remove)\n\n**Lot Details (per item if batch tracked):**\n- Lot Number\n- Quantity\n- Unit\n\n**Summary Panel:**\n- Total In Quantity\n- Total Out Quantity\n- Total Cost (currency formatted)\n\n#### 4.3 Right Panel\n\n**Tabs:**\n\n**Tab 1: Journal Entries**\n\n**Journal Header:**\n- Status\n- Journal Number\n- Posting Date\n- Posting Period\n- Description\n- Reference\n- Created by/at\n- Posted by/at\n\n**Journal Table:**\n- Account Code\n- Account Name\n- Debit amount\n- Credit amount\n- Department\n- Reference\n\n**Tab 2: Stock Movement Details**\n- Same as main table but read-only\n- Shows complete transaction details\n\n### Actions\n- Create new adjustment\n- Add items to adjustment\n- Edit quantities/lots\n- Save as draft\n- Post adjustment\n- View journal entry\n- Print adjustment voucher\n- Delete draft adjustment\n\n### Adjustment Flow\n```mermaid\ngraph TD\n    A[Create Adjustment] --> B[Select Type & Location]\n    B --> C[Add Items]\n    C --> D{Batch Tracked?}\n    D -->|Yes| E[Enter Lot Details]\n    D -->|No| F[Enter Quantity]\n    E --> G[Review Total]\n    F --> G\n    G --> H{Save or Post?}\n    H -->|Save| I[Save as Draft]\n    H -->|Post| J[Post to Inventory]\n    J --> K[Generate Journal Entry]\n    K --> L[Update Stock Levels]\n```\n\n### Journal Entry Auto-Generation\n\n**Positive Adjustment:**\n```\nDebit: Inventory Account (Location/Category)\nCredit: Inventory Adjustment Income\n```\n\n**Negative Adjustment:**\n```\nDebit: Cost of Goods Sold / Adjustment Expense\nCredit: Inventory Account (Location/Category)\n```\n\n---\n\n## 5. Physical Count\n\n**Route:** `/inventory-management/physical-count`\n\n### Purpose\nComprehensive physical count process with multi-step wizard for full location counts.\n\n### 5.1 Physical Count Wizard\n\n**Multi-step Process:**\n\n#### Step 1: Setup\n**Component:** `PhysicalCountSetup`\n\n**Fields:**\n- Counter Name (auto-filled from user)\n- Department dropdown\n- Date & Time picker\n- Count Type (Full/Partial)\n- Notes textarea\n\n**Validation:**\n- Department required\n- Date cannot be future\n\n#### Step 2: Location Selection\n**Component:** `LocationSelection`\n\n**Display:**\n- Checkbox tree of all locations\n- Location hierarchy:\n  - Building → Floor → Room → Sub-location\n- Select all/none buttons\n- Search locations\n\n**Features:**\n- Parent selection selects all children\n- Show item count per location\n- Disable locations with active counts\n\n#### Step 3: Item Review\n**Component:** `ItemReview`\n\n**Display:**\n- Items table based on selected locations\n- Columns:\n  - Item Code\n  - Item Name\n  - Category\n  - Location\n  - Expected Quantity\n  - Unit\n  - Last Count Date\n  - Checkbox (to exclude)\n\n**Features:**\n- Auto-populated from inventory\n- Exclude items checkbox\n- Filter by category\n- Sort by any column\n- Total items count\n\n#### Step 4: Final Review\n**Component:** `FinalReview`\n\n**Display:**\n- Summary of selections:\n  - Counter name\n  - Department\n  - Date/Time\n  - Locations count\n  - Items count\n  - Estimated duration\n- Full list review\n- Edit buttons to go back to any step\n\n**Actions:**\n- Back to edit\n- Save as draft\n- Start count\n\n### 5.2 Active Count\n\n**Route:** `/inventory-management/physical-count/active/[id]`\n\n**Display:**\n- Count reference at top\n- Progress indicator (X/Y items counted)\n- Filter by location\n- Search items\n\n**Item Entry Table:**\n- Item Code/Name\n- Expected Quantity\n- Actual Count (input field)\n- Variance (auto-calculated)\n- Variance %\n- Status indicator (good/variance)\n- Notes field\n- Checkbox \"Counted\"\n\n**Features:**\n- Save progress frequently (auto-save)\n- Mark items as counted\n- Flag discrepancies\n- Add notes per item\n- Barcode scanning support (future)\n\n**Actions:**\n- Save progress\n- Submit count (when all items counted)\n- Cancel count\n\n### 5.3 Physical Count Dashboard\n\n**Route:** `/inventory-management/physical-count/dashboard`\n\n**Displays:**\n\n**Summary Cards:**\n- Active Counts\n- Completed Today\n- Pending Review\n- Average Variance %\n\n**Counts Table:**\n- Count ID\n- Date\n- Location(s)\n- Items Count\n- Completed Items\n- Progress %\n- Status\n- Variance %\n- Actions (Resume/Review/Export)\n\n**Charts:**\n- Count completion trend (line chart)\n- Variance by location (bar chart)\n- Variance by category (pie chart)\n\n### Physical Count Flow\n```mermaid\ngraph TD\n    A[Start Count] --> B[Setup: Enter Details]\n    B --> C[Select Locations]\n    C --> D[Review Items]\n    D --> E[Final Review]\n    E --> F{Save or Start?}\n    F -->|Save| G[Save as Draft]\n    F -->|Start| H[Begin Counting]\n    H --> I[Enter Actual Counts]\n    I --> J{All Counted?}\n    J -->|No| K[Save Progress]\n    J -->|Yes| L[Submit Count]\n    K --> I\n    L --> M[Review Variances]\n    M --> N{Approve?}\n    N -->|Yes| O[Post Adjustment]\n    N -->|No| P[Recount Items]\n    O --> Q[Update Inventory]\n    P --> I\n```\n\n---\n\n## 6. Spot Check\n\n**Route:** `/inventory-management/spot-check`\n\n### Purpose\nQuick random spot checks of specific items for accuracy verification.\n\n### 6.1 Spot Check Main Page\n\n**Views:** List or Grid toggle\n\n**Filter Bar:**\n- Search box\n- Status dropdown (All/Pending/In Progress/Completed)\n- Department dropdown\n- Location filter button (toggles panel)\n\n**Location Filter Panel (Collapsible):**\n- Location dropdown\n- Active filter tag with X to clear\n\n#### List View\n**Component:** `CountListItem`\n\n**Displays per item:**\n- Store Name\n- Department badge\n- Counter name\n- Date\n- Status badge\n- Item count (e.g., \"10 items\")\n- Last count date\n- Variance % (if completed)\n- Progress (e.g., \"5/10 completed\")\n- Notes preview\n- Actions: Start Count / Delete\n\n#### Grid View\n**Component:** `CountDetailCard`\n\n**Card displays:**\n- Count ID\n- Counter name\n- Department\n- Store\n- Date\n- Selected items count\n- Action buttons: Start Count / Delete\n\n### 6.2 New Spot Check\n\n**Route:** `/inventory-management/spot-check/new`\n\n**Multi-step form:**\n\n#### Step 1: Setup\n**Component:** `Setup`\n\n**Fields:**\n- Department dropdown\n- Store/Location dropdown\n- Date/Time picker\n- Notes\n\n#### Step 2: Item Selection\n**Component:** `ItemSelection`\n\n**Features:**\n- Random item picker (click to auto-select X items)\n- Manual item search and add\n- Selected items list\n- Remove items\n\n**Selected Items Table:**\n- Item Code\n- Item Name\n- Expected Qty\n- Unit\n- Remove button\n\n#### Step 3: Review\n**Component:** `Review`\n\n**Display:**\n- Summary of setup\n- List of selected items\n- Total items count\n\n**Actions:**\n- Back to edit\n- Save as draft\n- Start spot check\n\n### 6.3 Active Spot Check\n\n**Route:** `/inventory-management/spot-check/active/[id]`\n\n**Component:** `CountItems`\n\n**Display:**\n- Spot check reference\n- Progress (X/Y items)\n- Item entry form:\n  - Item name/code\n  - Expected quantity\n  - Actual count input\n  - Variance (auto-calculated)\n  - Status dropdown (Good/Damaged/Missing/Expired)\n  - Notes\n  - Checkbox \"Submit item\"\n\n**Features:**\n- One item at a time or table view\n- Submit per item\n- Flag issues immediately\n- Photo upload for discrepancies\n\n**Actions:**\n- Submit item count\n- Complete spot check\n- Cancel\n\n### 6.4 Completed Spot Checks\n\n**Route:** `/inventory-management/spot-check/completed`\n\n**Display:** Similar to main page but filtered to completed status\n\n**Additional columns:**\n- Variance %\n- Completion date\n- Actions: View Details / Export\n\n### 6.5 Spot Check Dashboard\n\n**Route:** `/inventory-management/spot-check/dashboard`\n\n**Summary Cards:**\n- Total Spot Checks This Week\n- Average Accuracy %\n- Items Flagged\n- Pending Actions\n\n**Charts:**\n- Accuracy trend (line)\n- Variance by location (bar)\n- Issue types distribution (pie)\n\n**Recent Spot Checks Table:**\n- Date\n- Location\n- Items\n- Accuracy %\n- Issues found\n- Status\n\n### Spot Check Flow\n```mermaid\ngraph TD\n    A[New Spot Check] --> B[Select Department & Location]\n    B --> C[Choose Items]\n    C --> D{Random or Manual?}\n    D -->|Random| E[Auto-select N items]\n    D -->|Manual| F[Search and add items]\n    E --> G[Review Selection]\n    F --> G\n    G --> H[Start Spot Check]\n    H --> I[Count Each Item]\n    I --> J[Enter Actual Count]\n    J --> K{Match?}\n    K -->|Yes| L[Mark as Good]\n    K -->|No| M[Flag Variance]\n    L --> N{More Items?}\n    M --> O[Add Notes/Photo]\n    O --> N\n    N -->|Yes| I\n    N -->|No| P[Complete Check]\n    P --> Q[Generate Report]\n```\n\n---\n\n## 7. Fractional Inventory\n\n**Route:** `/inventory-management/fractional-inventory`\n\n### Purpose\nManage portion-based inventory for items that can be split or combined (e.g., pizzas into slices).\n\n### Layout\n\n**Tabs:**\n1. Inventory Dashboard\n2. Conversion Tracking\n\n### 7.1 Inventory Dashboard Tab\n**Component:** `FractionalInventoryDashboard`\n\n**Summary Cards:**\n- Total Fractional Items\n- Active Portions\n- Pending Conversions\n- Waste Generated Today\n\n**Fractional Stock Table:**\n- Item Code/Name\n- Current State (WHOLE/PARTIAL/PREPARED)\n- Whole Units Available\n- Partial Quantity Available\n- Total Portions Available\n- Reserved Portions\n- Quality Grade (EXCELLENT/GOOD/FAIR/POOR)\n- Expires At (countdown)\n- Actions:\n  - Split (convert whole to portions)\n  - Combine (combine portions to whole)\n  - View Details\n\n**Filters:**\n- Location\n- State (Whole/Partial/Prepared)\n- Quality Grade\n- Expiring Soon (< 4 hours)\n\n### 7.2 Conversion Operations Modal\n**Component:** `ConversionOperationsModal`\n\n**Triggered by:** Click Split or Combine action\n\n**Split Operation Form:**\n- Stock ID (read-only)\n- Item Name (read-only)\n- Available Whole Units (read-only)\n- Split Quantity (input)\n- Target Portion Size (dropdown):\n  - e.g., \"Slice (8 per whole)\"\n  - \"Half (2 per whole)\"\n- Resulting Portions (calculated)\n- Conversion Cost (calculated)\n- Reason (dropdown: Sales Preparation / Buffet Service / Portion Control / Other)\n- Notes\n\n**Combine Operation Form:**\n- Stock ID (read-only)\n- Item Name (read-only)\n- Available Portions (read-only)\n- Combine Quantity (input - in portions)\n- Target: Whole Unit\n- Waste % (calculated)\n- Reason (dropdown: Consolidation / Quality Control / Inventory Optimization / Other)\n- Notes\n\n**Actions:**\n- Cancel\n- Confirm Conversion\n\n### 7.3 Conversion Tracking Tab\n**Component:** `ConversionTrackingPanel`\n\n**Displays:**\n\n**Recent Conversions Table:**\n- Date/Time\n- Item Name\n- Operation Type (Split/Combine)\n- From State → To State\n- Quantity Converted\n- Resulting Units/Portions\n- Waste Generated\n- Performed By\n- Reason\n- Notes\n\n**Filters:**\n- Date range\n- Operation type\n- Item\n- Performed by\n\n**Charts:**\n- Conversions over time (line)\n- Waste by item (bar)\n- Operation type distribution (pie)\n\n### Data Types\n\n```typescript\ninterface FractionalItem {\n  id: string\n  itemCode: string\n  itemName: string\n  category: string\n  baseUnit: string // \"Whole Pizza\"\n  supportsFractional: boolean\n  allowPartialSales: boolean\n  trackPortions: boolean\n  availablePortions: PortionSize[]\n  defaultPortionId: string\n  shelfLifeHours: number\n  maxQualityHours: number\n  allowAutoConversion: boolean\n  wastePercentage: number\n  baseCostPerUnit: number\n  conversionCostPerUnit: number\n}\n\ninterface PortionSize {\n  id: string\n  name: string // \"Slice\"\n  portionsPerWhole: number // 8\n  isActive: boolean\n}\n\ninterface FractionalStock {\n  id: string\n  itemId: string\n  locationId: string\n  currentState: 'WHOLE' | 'PARTIAL' | 'PREPARED'\n  stateTransitionDate: string\n  qualityGrade: 'EXCELLENT' | 'GOOD' | 'FAIR' | 'POOR'\n  wholeUnitsAvailable: number\n  partialQuantityAvailable: number\n  totalPortionsAvailable: number\n  reservedPortions: number\n  originalWholeUnits: number\n  originalTotalPortions: number\n  conversionsApplied: ConversionRecord[]\n  totalWasteGenerated: number\n  preparedAt: string\n  expiresAt: string\n}\n\ninterface ConversionRecord {\n  id: string\n  timestamp: string\n  operationType: 'SPLIT' | 'COMBINE'\n  fromState: string\n  toState: string\n  quantityBefore: number\n  quantityAfter: number\n  portionsCreated?: number\n  wasteGenerated: number\n  performedBy: string\n  reason: string\n  notes: string\n}\n```\n\n### Fractional Inventory Flow\n```mermaid\ngraph TD\n    A[View Fractional Stock] --> B{Action?}\n    B -->|Split| C[Select Split Quantity]\n    B -->|Combine| D[Select Combine Quantity]\n    C --> E[Select Portion Size]\n    D --> F[Specify Whole Units]\n    E --> G[Calculate Result]\n    F --> H[Calculate Waste]\n    G --> I[Enter Reason]\n    H --> I\n    I --> J[Confirm Operation]\n    J --> K[Update Stock]\n    K --> L[Record Conversion]\n    L --> M[Calculate New Quality]\n    M --> N[Update Expiry Time]\n```\n\n---\n\n## 8. Period End\n\n**Route:** `/inventory-management/period-end`\n\n### Purpose\nManage month-end inventory closing procedures.\n\n### Components\n\n#### Header Section\n- Title: \"Period End\"\n- Subtitle: \"Manage your inventory period end closings\"\n- Date picker (to select period)\n- \"Start New Period\" button\n\n#### Period End Records Table\n\n**Columns:**\n- Period ID (e.g., \"PE-2024-01\")\n- Period (e.g., \"January 2024\")\n- Start Date\n- End Date\n- Status badge (Open/In Progress/Closed)\n- Completed By\n- Completed At\n- Notes\n\n**Row Actions:**\n- Click row → Navigate to period detail\n\n**Status Badges:**\n- Open: Blue\n- In Progress: Yellow\n- Closed: Green\n\n### 8.1 Period End Detail\n\n**Route:** `/inventory-management/period-end/[id]`\n\n**Sections:**\n\n**Header:**\n- Period ID\n- Status badge\n- Close Period button (if in progress)\n\n**Summary Panel:**\n- Period range\n- Opening stock value\n- Closing stock value\n- Variance\n- Physical count status\n- Adjustment count\n- Status\n\n**Checklist:**\n- [ ] All stock receipts posted\n- [ ] All stock issues posted\n- [ ] Physical count completed\n- [ ] Variances reconciled\n- [ ] Adjustments posted\n- [ ] Reports generated\n- [ ] Finance reviewed\n\n**Reports Section:**\n- Inventory valuation report\n- Movement summary\n- Variance analysis\n- Period-end snapshot\n\n### Period End Flow\n```mermaid\ngraph TD\n    A[Start Period End] --> B[Run Pre-checks]\n    B --> C{All Transactions Posted?}\n    C -->|No| D[Complete Pending]\n    C -->|Yes| E[Perform Physical Count]\n    D --> B\n    E --> F[Reconcile Variances]\n    F --> G[Post Adjustments]\n    G --> H[Generate Reports]\n    H --> I[Finance Review]\n    I --> J{Approve?}\n    J -->|No| K[Make Corrections]\n    J -->|Yes| L[Close Period]\n    K --> F\n    L --> M[Lock Transactions]\n    M --> N[Archive Reports]\n```\n\n---\n\n## 9. Physical Count Management\n\n**Route:** `/inventory-management/physical-count-management`\n\n### Purpose\nSchedule and manage physical counts across multiple locations.\n\n### Components\n\n**Header:**\n- Title: \"Physical Count Management\"\n- \"New Count\" button\n\n#### Scheduled Counts List\n\n**Filter Bar:**\n- Status filter\n- Location filter\n- Date range\n\n**Cards/List Items:**\n**Component:** `CountListItem`\n\n**Display:**\n- Store Name\n- Department\n- Counter assigned\n- Scheduled Date\n- Status (Scheduled/In Progress/Completed)\n- Item count\n- Completed count (progress)\n- Variance %\n- Actions: Start / Edit / Delete\n\n#### Count Detail Form\n**Component:** `CountDetailForm`\n\n**For creating/editing counts:**\n\n**Fields:**\n- Location dropdown\n- Counter assignment\n- Scheduled date/time\n- Count type (Full/Partial/Spot)\n- Items selection (if partial)\n- Notes\n- Recurrence (One-time / Weekly / Monthly)\n\n**Actions:**\n- Save\n- Schedule\n- Cancel\n\n### Count Progress Tracking\n**Component:** `CountProgress`\n\n**Display:**\n- Overall progress %\n- Items counted / Total items\n- Variance summary\n- Issues flagged\n- Estimated completion time\n\n---\n\n## 10. Common Components\n\n### 10.1 Grouped Table\n**Component:** `GroupedTable`\n**Location:** `components/inventory/GroupedTable.tsx`\n\n**Purpose:** Hierarchical data display with expand/collapse\n\n**Features:**\n- Multiple grouping levels\n- Subtotals per group\n- Expand all / Collapse all\n- Custom row rendering\n- Sort within groups\n\n**Props:**\n```typescript\ninterface GroupedTableProps {\n  data: any[]\n  groupBy: string[]\n  columns: ColumnDef[]\n  renderSubtotal?: (group: any) => ReactNode\n  expandAll?: boolean\n}\n```\n\n### 10.2 Export Button\n**Component:** `ExportButton`\n**Location:** `components/inventory/ExportButton.tsx`\n\n**Purpose:** Export data to various formats\n\n**Formats:**\n- Excel (.xlsx)\n- PDF\n- CSV\n\n**Props:**\n```typescript\ninterface ExportButtonProps {\n  data: any[]\n  filename: string\n  format: 'excel' | 'pdf' | 'csv'\n  columns?: string[]\n}\n```\n\n### 10.3 Step Indicator\n**Component:** `StepIndicator`\n**Location:** `components/ui/step-indicator.tsx`\n\n**Purpose:** Show progress in multi-step wizards\n\n**Display:**\n- Step number circles\n- Step titles\n- Step descriptions\n- Progress line\n- Current step highlight\n\n**Props:**\n```typescript\ninterface StepIndicatorProps {\n  steps: Array<{\n    title: string\n    description: string\n  }>\n  currentStep: number\n}\n```\n\n### 10.4 Count Detail Form\n**Component:** `CountDetailForm`\n**Used in:** Spot Check, Physical Count Management\n\n**Purpose:** Reusable form for entering count details\n\n**Fields:**\n- Items table with actual count inputs\n- Location name (display)\n- User name (display)\n- Date (display)\n- Reference (display)\n- Item entry fields:\n  - Expected quantity\n  - Actual count\n  - Variance (calculated)\n  - Status\n  - Notes\n\n**Actions:**\n- Close modal\n- Submit counts\n\n### 10.5 Count List Item\n**Component:** `CountListItem`\n**Used in:** Spot Check, Physical Count Management\n\n**Purpose:** Display count summary in list view\n\n**Shows:**\n- Location/Store name\n- Department\n- User\n- Date\n- Status badge\n- Item count\n- Progress\n- Variance\n- Notes preview\n\n**Actions:**\n- Start count\n- Delete\n\n### 10.6 Count Detail Card\n**Component:** `CountDetailCard`\n**Used in:** Spot Check grid view\n\n**Purpose:** Card display of count\n\n**Shows:**\n- Count ID\n- Counter\n- Department\n- Store\n- Date\n- Selected items count\n\n**Actions:**\n- Start count\n- Delete\n\n### 10.7 Stock In Journal Entry\n**Component:** `stock-in-jv-entry.tsx`\n\n**Purpose:** Display auto-generated journal entries for stock receipts\n\n**Shows:**\n- Journal header\n- Entry lines (debit/credit)\n- Account codes\n- Amounts\n- Department allocation\n\n---\n\n## Modal Components\n\n### Location Selection Modal\n**Used in:** Physical Count, Spot Check\n\n**Features:**\n- Hierarchical location tree\n- Multi-select checkboxes\n- Search locations\n- Filter by type\n\n### Item Lookup Modal\n**Used in:** Stock In, Adjustments, Counts\n\n**Features:**\n- Search items\n- Filter by category\n- Show stock levels\n- Multi-select\n- Add to document\n\n### Lot Entry Modal\n**Used in:** Stock In, Adjustments\n\n**For batch-tracked items:**\n- Lot number input\n- Expiry date picker\n- Quantity allocation\n- Multiple lots per item\n\n---\n\n## Common Dropdown Fields\n\n### Department Dropdown\n**Options:** From centralized mock data\n**Used in:** Most forms\n\n### Location Dropdown\n**Options:** Filtered by user permissions\n**Hierarchy:** Building > Floor > Room > Storage\n**Used in:** All inventory transactions\n\n### Reason Dropdown (Adjustments)\n**Options:**\n- Physical count variance\n- Damage\n- Theft\n- Expiry\n- Found stock\n- Transfer\n- Production\n- Quality control\n- System correction\n- Other (with notes field)\n\n### Status Filters\n**Common statuses across modules:**\n- Draft\n- Pending\n- In Progress\n- Completed\n- Posted\n- Cancelled\n\n---\n\n## Common Actions\n\n### Save as Draft\n- Saves form data\n- Does not update inventory\n- Can be edited later\n- No journal entry created\n\n### Post / Submit\n- Finalizes transaction\n- Updates inventory levels\n- Generates journal entry\n- Locks transaction\n- Sends notifications\n\n### Cancel\n- Discards changes\n- Confirms with user\n- Returns to list view\n\n### Export\n- Generates file in selected format\n- Downloads to user device\n- Options: Excel, PDF, CSV\n\n### Print\n- Opens print dialog\n- Formatted for paper\n- Includes company header/footer\n\n---\n\n## Validation Rules\n\n### Common Validations\n- Required fields marked with *\n- Date validations (no future dates for receipts)\n- Quantity > 0\n- Cost >= 0\n- Location permissions check\n- Batch/lot required if item is batch-tracked\n- Expiry date required for perishables\n\n### Permissions\n- View: Can see data\n- Create: Can create new records\n- Edit: Can modify drafts\n- Post: Can finalize transactions\n- Delete: Can remove drafts\n- Void: Can cancel posted transactions\n\n---\n\n## Screen Responsiveness\n\n### Breakpoints\n- Mobile: < 640px\n- Tablet: 640px - 1024px\n- Desktop: > 1024px\n\n### Mobile Adaptations\n- Tables convert to cards\n- Multi-column grids become single column\n- Filters collapse to dropdown\n- Actions move to slide-out menu\n- Charts resize responsively\n\n### Tablet Adaptations\n- 2-column grids\n- Horizontal scrolling tables\n- Bottom sheet for filters\n- Collapsible sidebars\n\n---\n\n## Error States\n\n### Common Error Patterns\n- Empty state with illustration\n- Error message with retry button\n- Validation errors inline\n- Toast notifications for actions\n- Modal confirmations for destructive actions\n\n### Empty States\n- \"No records found\"\n- \"Start by creating your first...\"\n- Helpful tips/documentation links\n- Create new button prominent\n\n---\n\nThis comprehensive specification covers all major pages, components, modals, flows, and features of the Inventory Management module. Each section can be used as a reference for development, testing, or documentation purposes.\n";

        // Initialize mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });

        // Configure marked
        marked.setOptions({
            highlight: function(code, lang) {
                return code;
            },
            breaks: true,
            gfm: true
        });

        // Render markdown
        document.getElementById('markdown-content').innerHTML = marked.parse(markdownContent);

        // Render mermaid diagrams
        mermaid.contentLoaded();
    </script>
</body>
</html>