# Carmen to Keycloak Migration Configuration
# Copy this file to .env and update with your specific configuration

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# PostgreSQL database connection for Carmen ERP
DB_HOST=localhost
DB_PORT=5432
DB_NAME=carmen
DB_USERNAME=postgres
DB_PASSWORD=postgres
DB_SSL=false

# Database connection pool settings
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_POOL_IDLE_TIMEOUT=30000
DB_POOL_CONNECTION_TIMEOUT=2000

# ============================================================================
# KEYCLOAK CONFIGURATION
# ============================================================================

# Keycloak server configuration
KEYCLOAK_BASE_URL=http://localhost:8080
KEYCLOAK_REALM=carmen
KEYCLOAK_ADMIN_USERNAME=admin
KEYCLOAK_ADMIN_PASSWORD=admin

# Keycloak client configuration
KEYCLOAK_CLIENT_ID=carmen-erp
KEYCLOAK_CLIENT_SECRET=your-client-secret-here

# Keycloak realm configuration
KEYCLOAK_REALM_DISPLAY_NAME=Carmen ERP
KEYCLOAK_REALM_ENABLED=true
KEYCLOAK_REGISTRATION_ALLOWED=false
KEYCLOAK_RESET_PASSWORD_ALLOWED=true
KEYCLOAK_REMEMBER_ME=true
KEYCLOAK_VERIFY_EMAIL=false
KEYCLOAK_LOGIN_WITH_EMAIL_ALLOWED=true

# Security settings
KEYCLOAK_SSL_REQUIRED=external
KEYCLOAK_BRUTE_FORCE_PROTECTED=true
KEYCLOAK_PERMANENT_LOCKOUT=false
KEYCLOAK_MAX_FAILURE_WAIT_SECONDS=900
KEYCLOAK_MINIMUM_QUICK_LOGIN_WAIT_SECONDS=60

# ============================================================================
# MIGRATION CONFIGURATION
# ============================================================================

# Migration paths
MIGRATION_EXPORT_PATH=/tmp
MIGRATION_IMPORT_PATH=/tmp/keycloak_import
MIGRATION_LOG_PATH=/tmp/keycloak_migration_logs
MIGRATION_BACKUP_PATH=/backup/carmen_migration

# Migration settings
MIGRATION_BATCH_SIZE=50
MIGRATION_RETRY_ATTEMPTS=3
MIGRATION_RETRY_DELAY=1000
MIGRATION_TIMEOUT=300000

# Interactive mode settings
MIGRATION_INTERACTIVE=true
MIGRATION_AUTO_CONFIRM=false
MIGRATION_DRY_RUN=false

# Validation settings
MIGRATION_SKIP_VALIDATION=false
MIGRATION_SKIP_PRE_CHECKS=false
MIGRATION_SKIP_POST_VALIDATION=false

# ============================================================================
# PERFORMANCE CONFIGURATION
# ============================================================================

# Performance tuning
MAX_CONCURRENT_OPERATIONS=5
ENABLE_PARALLEL_PROCESSING=true
MEMORY_LIMIT_MB=2048

# Progress reporting
ENABLE_PROGRESS_BARS=true
LOG_LEVEL=INFO
VERBOSE_LOGGING=false

# ============================================================================
# BACKUP AND RECOVERY
# ============================================================================

# Backup configuration
ENABLE_AUTO_BACKUP=true
BACKUP_DATABASE_BEFORE_MIGRATION=true
BACKUP_KEYCLOAK_BEFORE_MIGRATION=true
BACKUP_RETENTION_DAYS=30

# Recovery settings
ENABLE_ROLLBACK_CAPABILITY=true
ROLLBACK_TIMEOUT_MINUTES=30

# ============================================================================
# NETWORK AND SECURITY
# ============================================================================

# Network timeouts
HTTP_TIMEOUT=30000
DB_CONNECT_TIMEOUT=10000
KEYCLOAK_API_TIMEOUT=60000

# Security settings
ENABLE_SSL_VERIFICATION=true
ALLOW_SELF_SIGNED_CERTS=false
API_RATE_LIMIT_ENABLED=true

# ============================================================================
# DEVELOPMENT AND TESTING
# ============================================================================

# Environment
NODE_ENV=production
DEBUG=false

# Testing configuration (only for development/staging)
TEST_MODE=false
MOCK_KEYCLOAK_RESPONSES=false
SKIP_EXTERNAL_DEPENDENCIES=false

# Development overrides
DEV_SKIP_CONFIRMATIONS=false
DEV_USE_SAMPLE_DATA=false
DEV_ENABLE_DEBUG_LOGGING=false

# ============================================================================
# MONITORING AND ALERTING
# ============================================================================

# Monitoring configuration
ENABLE_METRICS_COLLECTION=true
METRICS_ENDPOINT=/metrics
HEALTH_CHECK_ENDPOINT=/health

# Alerting (optional)
SLACK_WEBHOOK_URL=
EMAIL_NOTIFICATIONS_ENABLED=false
NOTIFICATION_EMAIL=admin@yourcompany.com

# ============================================================================
# APPLICATION INTEGRATION
# ============================================================================

# Carmen ERP application configuration
CARMEN_BASE_URL=http://localhost:3000
CARMEN_API_KEY=your-api-key-here

# Post-migration application configuration
POST_MIGRATION_UPDATE_CONFIG=true
POST_MIGRATION_RESTART_REQUIRED=true

# ============================================================================
# ADVANCED CONFIGURATION
# ============================================================================

# Role mapping configuration
ENABLE_CUSTOM_ROLE_MAPPING=false
CUSTOM_ROLE_MAPPING_FILE=config/custom_role_mapping.json

# User attribute mapping
ENABLE_CUSTOM_ATTRIBUTE_MAPPING=false
CUSTOM_ATTRIBUTE_MAPPING_FILE=config/custom_attribute_mapping.json

# Group configuration
AUTO_CREATE_GROUPS=true
GROUP_HIERARCHY_ENABLED=true

# Password policy configuration
FORCE_PASSWORD_RESET=true
PASSWORD_POLICY_LENGTH=8
PASSWORD_POLICY_UPPERCASE=true
PASSWORD_POLICY_LOWERCASE=true
PASSWORD_POLICY_DIGITS=true
PASSWORD_POLICY_SPECIAL_CHARS=false

# Session configuration
SESSION_TIMEOUT_MINUTES=480
SSO_SESSION_TIMEOUT_MINUTES=600
OFFLINE_SESSION_TIMEOUT_DAYS=30

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

# Log levels: ERROR, WARN, INFO, DEBUG, TRACE
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_TO_FILE=true
LOG_FILE_PATH=/tmp/keycloak_migration_logs/migration.log
LOG_MAX_FILE_SIZE=10MB
LOG_MAX_FILES=5

# Audit logging
ENABLE_AUDIT_LOGGING=true
AUDIT_LOG_PATH=/tmp/keycloak_migration_logs/audit.log

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Enable/disable specific migration features
ENABLE_USER_MIGRATION=true
ENABLE_ROLE_MIGRATION=true
ENABLE_GROUP_MIGRATION=true
ENABLE_PERMISSION_MIGRATION=true
ENABLE_ATTRIBUTE_MIGRATION=true

# Advanced features
ENABLE_COMPOSITE_ROLES=true
ENABLE_CLIENT_SCOPES=true
ENABLE_AUTHORIZATION_SERVICES=true
ENABLE_IDENTITY_PROVIDERS=false

# ============================================================================
# ENVIRONMENT-SPECIFIC OVERRIDES
# ============================================================================

# Development environment overrides
# Uncomment and modify for development environment
# DB_HOST=localhost
# KEYCLOAK_BASE_URL=http://localhost:8080
# MIGRATION_INTERACTIVE=true
# LOG_LEVEL=DEBUG

# Staging environment overrides
# Uncomment and modify for staging environment
# DB_HOST=staging-db.yourcompany.com
# KEYCLOAK_BASE_URL=https://staging-keycloak.yourcompany.com
# MIGRATION_INTERACTIVE=false
# MIGRATION_AUTO_CONFIRM=true

# Production environment overrides
# Uncomment and modify for production environment
# DB_HOST=prod-db.yourcompany.com
# KEYCLOAK_BASE_URL=https://keycloak.yourcompany.com
# MIGRATION_INTERACTIVE=false
# MIGRATION_AUTO_CONFIRM=false
# ENABLE_AUTO_BACKUP=true
# LOG_LEVEL=WARN